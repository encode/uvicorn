{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"]},"docs":[{"location":"","title":"Introduction","text":"<p> An ASGI web server, for Python. </p> <p> </p> <p>Documentation: https://www.uvicorn.org</p> <p>Source Code: https://www.github.com/encode/uvicorn</p> <p>Uvicorn is an ASGI web server implementation for Python.</p> <p>Until recently Python has lacked a minimal low-level server/application interface for async frameworks. The ASGI specification fills this gap, and means we're now able to start building a common set of tooling usable across all async frameworks.</p> <p>Uvicorn currently supports HTTP/1.1 and WebSockets.</p>"},{"location":"#quickstart","title":"Quickstart","text":"<p>Install using <code>pip</code>:</p> <pre><code>pip install uvicorn\n</code></pre> <p>This will install uvicorn with minimal (pure Python) dependencies.</p> <pre><code>pip install 'uvicorn[standard]'\n</code></pre> <p>This will install uvicorn with \"Cython-based\" dependencies (where possible) and other \"optional extras\".</p> <p>In this context, \"Cython-based\" means the following:</p> <ul> <li>the event loop <code>uvloop</code> will be installed and used if possible.</li> <li><code>uvloop</code> is a fast, drop-in replacement of the built-in asyncio event loop. It is implemented in Cython. Read more here.</li> <li>The built-in asyncio event loop serves as an easy-to-read reference implementation and is there for easy debugging as it's pure-python based.</li> <li>the http protocol will be handled by <code>httptools</code> if possible.</li> <li>Read more about comparison with <code>h11</code> here.</li> </ul> <p>Moreover, \"optional extras\" means that:</p> <ul> <li>the websocket protocol will be handled by <code>websockets</code> (should you want to use <code>wsproto</code> you'd need to install it manually) if possible.</li> <li>the <code>--reload</code> flag in development mode will use <code>watchfiles</code>.</li> <li>Windows users will have <code>colorama</code> installed for the colored logs.</li> <li><code>python-dotenv</code> will be installed should you want to use the <code>--env-file</code> option.</li> <li><code>PyYAML</code> will be installed to allow you to provide a <code>.yaml</code> file to <code>--log-config</code>, if desired.</li> </ul> <p>Create an application:</p> main.py<pre><code>async def app(scope, receive, send):\n    assert scope['type'] == 'http'\n\n    await send({\n        'type': 'http.response.start',\n        'status': 200,\n        'headers': [\n            (b'content-type', b'text/plain'),\n            (b'content-length', b'13'),\n        ],\n    })\n    await send({\n        'type': 'http.response.body',\n        'body': b'Hello, world!',\n    })\n</code></pre> <p>Run the server:</p> <pre><code>uvicorn main:app\n</code></pre>"},{"location":"#usage","title":"Usage","text":"<p>The uvicorn command line tool is the easiest way to run your application.</p>"},{"location":"#command-line-options","title":"Command line options","text":"<pre><code>Usage: uvicorn [OPTIONS] APP\n\nOptions:\n  --host TEXT                     Bind socket to this host.  [default:\n                                  127.0.0.1]\n  --port INTEGER                  Bind socket to this port. If 0, an available\n                                  port will be picked.  [default: 8000]\n  --uds TEXT                      Bind to a UNIX domain socket.\n  --fd INTEGER                    Bind to socket from this file descriptor.\n  --reload                        Enable auto-reload.\n  --reload-dir PATH               Set reload directories explicitly, instead\n                                  of using the current working directory.\n  --reload-include TEXT           Set glob patterns to include while watching\n                                  for files. Includes '*.py' by default; these\n                                  defaults can be overridden with `--reload-\n                                  exclude`. This option has no effect unless\n                                  watchfiles is installed.\n  --reload-exclude TEXT           Set glob patterns to exclude while watching\n                                  for files. Includes '.*, .py[cod], .sw.*,\n                                  ~*' by default; these defaults can be\n                                  overridden with `--reload-include`. This\n                                  option has no effect unless watchfiles is\n                                  installed.\n  --reload-delay FLOAT            Delay between previous and next check if\n                                  application needs to be. Defaults to 0.25s.\n                                  [default: 0.25]\n  --workers INTEGER               Number of worker processes. Defaults to the\n                                  $WEB_CONCURRENCY environment variable if\n                                  available, or 1. Not valid with --reload.\n  --loop [auto|asyncio|uvloop]    Event loop implementation.  [default: auto]\n  --http [auto|h11|httptools]     HTTP protocol implementation.  [default:\n                                  auto]\n  --ws [auto|none|websockets|websockets-sansio|wsproto]\n                                  WebSocket protocol implementation.\n                                  [default: auto]\n  --ws-max-size INTEGER           WebSocket max size message in bytes\n                                  [default: 16777216]\n  --ws-max-queue INTEGER          The maximum length of the WebSocket message\n                                  queue.  [default: 32]\n  --ws-ping-interval FLOAT        WebSocket ping interval in seconds.\n                                  [default: 20.0]\n  --ws-ping-timeout FLOAT         WebSocket ping timeout in seconds.\n                                  [default: 20.0]\n  --ws-per-message-deflate BOOLEAN\n                                  WebSocket per-message-deflate compression\n                                  [default: True]\n  --lifespan [auto|on|off]        Lifespan implementation.  [default: auto]\n  --interface [auto|asgi3|asgi2|wsgi]\n                                  Select ASGI3, ASGI2, or WSGI as the\n                                  application interface.  [default: auto]\n  --env-file PATH                 Environment configuration file.\n  --log-config PATH               Logging configuration file. Supported\n                                  formats: .ini, .json, .yaml.\n  --log-level [critical|error|warning|info|debug|trace]\n                                  Log level. [default: info]\n  --access-log / --no-access-log  Enable/Disable access log.\n  --use-colors / --no-use-colors  Enable/Disable colorized logging.\n  --proxy-headers / --no-proxy-headers\n                                  Enable/Disable X-Forwarded-Proto,\n                                  X-Forwarded-For to populate url scheme and\n                                  remote address info.\n  --server-header / --no-server-header\n                                  Enable/Disable default Server header.\n  --date-header / --no-date-header\n                                  Enable/Disable default Date header.\n  --forwarded-allow-ips TEXT      Comma separated list of IP Addresses, IP\n                                  Networks, or literals (e.g. UNIX Socket\n                                  path) to trust with proxy headers. Defaults\n                                  to the $FORWARDED_ALLOW_IPS environment\n                                  variable if available, or '127.0.0.1'. The\n                                  literal '*' means trust everything.\n  --root-path TEXT                Set the ASGI 'root_path' for applications\n                                  submounted below a given URL path.\n  --limit-concurrency INTEGER     Maximum number of concurrent connections or\n                                  tasks to allow, before issuing HTTP 503\n                                  responses.\n  --backlog INTEGER               Maximum number of connections to hold in\n                                  backlog\n  --limit-max-requests INTEGER    Maximum number of requests to service before\n                                  terminating the process.\n  --timeout-keep-alive INTEGER    Close Keep-Alive connections if no new data\n                                  is received within this timeout.  [default:\n                                  5]\n  --timeout-graceful-shutdown INTEGER\n                                  Maximum number of seconds to wait for\n                                  graceful shutdown.\n  --ssl-keyfile TEXT              SSL key file\n  --ssl-certfile TEXT             SSL certificate file\n  --ssl-keyfile-password TEXT     SSL keyfile password\n  --ssl-version INTEGER           SSL version to use (see stdlib ssl module's)\n                                  [default: 17]\n  --ssl-cert-reqs INTEGER         Whether client certificate is required (see\n                                  stdlib ssl module's)  [default: 0]\n  --ssl-ca-certs TEXT             CA certificates file\n  --ssl-ciphers TEXT              Ciphers to use (see stdlib ssl module's)\n                                  [default: TLSv1]\n  --header TEXT                   Specify custom default HTTP response headers\n                                  as a Name:Value pair\n  --version                       Display the uvicorn version and exit.\n  --app-dir TEXT                  Look for APP in the specified directory, by\n                                  adding this to the PYTHONPATH. Defaults to\n                                  the current working directory.  [default:\n                                  \"\"]\n  --h11-max-incomplete-event-size INTEGER\n                                  For h11, the maximum number of bytes to\n                                  buffer of an incomplete event.\n  --factory                       Treat APP as an application factory, i.e. a\n                                  () -&gt; &lt;ASGI app&gt; callable.\n  --help                          Show this message and exit.\n</code></pre> <p>For more information, see the settings documentation.</p>"},{"location":"#running-programmatically","title":"Running programmatically","text":"<p>There are several ways to run uvicorn directly from your application.</p>"},{"location":"#uvicornrun","title":"<code>uvicorn.run</code>","text":"<p>If you're looking for a programmatic equivalent of the <code>uvicorn</code> command line interface, use <code>uvicorn.run()</code>:</p> main.py<pre><code>import uvicorn\n\nasync def app(scope, receive, send):\n    ...\n\nif __name__ == \"__main__\":\n    uvicorn.run(\"main:app\", port=5000, log_level=\"info\")\n</code></pre>"},{"location":"#config-and-server-instances","title":"<code>Config</code> and <code>Server</code> instances","text":"<p>For more control over configuration and server lifecycle, use <code>uvicorn.Config</code> and <code>uvicorn.Server</code>:</p> main.py<pre><code>import uvicorn\n\nasync def app(scope, receive, send):\n    ...\n\nif __name__ == \"__main__\":\n    config = uvicorn.Config(\"main:app\", port=5000, log_level=\"info\")\n    server = uvicorn.Server(config)\n    server.run()\n</code></pre> <p>If you'd like to run Uvicorn from an already running async environment, use <code>uvicorn.Server.serve()</code> instead:</p> main.py<pre><code>import asyncio\nimport uvicorn\n\nasync def app(scope, receive, send):\n    ...\n\nasync def main():\n    config = uvicorn.Config(\"main:app\", port=5000, log_level=\"info\")\n    server = uvicorn.Server(config)\n    await server.serve()\n\nif __name__ == \"__main__\":\n    asyncio.run(main())\n</code></pre>"},{"location":"#running-with-gunicorn","title":"Running with Gunicorn","text":"<p>Warning</p> <p>The <code>uvicorn.workers</code> module is deprecated and will be removed in a future release.</p> <p>You should use the <code>uvicorn-worker</code> package instead.</p> <pre><code>python -m pip install uvicorn-worker\n</code></pre> <p>Gunicorn is a mature, fully featured server and process manager.</p> <p>Uvicorn includes a Gunicorn worker class allowing you to run ASGI applications, with all of Uvicorn's performance benefits, while also giving you Gunicorn's fully-featured process management.</p> <p>This allows you to increase or decrease the number of worker processes on the fly, restart worker processes gracefully, or perform server upgrades without downtime.</p> <p>For production deployments we recommend using gunicorn with the uvicorn worker class.</p> <pre><code>gunicorn example:app -w 4 -k uvicorn.workers.UvicornWorker\n</code></pre> <p>For a PyPy compatible configuration use <code>uvicorn.workers.UvicornH11Worker</code>.</p> <p>For more information, see the deployment documentation.</p>"},{"location":"#application-factories","title":"Application factories","text":"<p>The <code>--factory</code> flag allows loading the application from a factory function, rather than an application instance directly. The factory will be called with no arguments and should return an ASGI application.</p> main.py<pre><code>def create_app():\n    app = ...\n    return app\n</code></pre> <pre><code>uvicorn --factory main:create_app\n</code></pre>"},{"location":"#the-asgi-interface","title":"The ASGI interface","text":"<p>Uvicorn uses the ASGI specification for interacting with an application.</p> <p>The application should expose an async callable which takes three arguments:</p> <ul> <li><code>scope</code> - A dictionary containing information about the incoming connection.</li> <li><code>receive</code> - A channel on which to receive incoming messages from the server.</li> <li><code>send</code> - A channel on which to send outgoing messages to the server.</li> </ul> <p>Two common patterns you might use are either function-based applications:</p> <pre><code>async def app(scope, receive, send):\n    assert scope['type'] == 'http'\n    ...\n</code></pre> <p>Or instance-based applications:</p> <pre><code>class App:\n    async def __call__(self, scope, receive, send):\n        assert scope['type'] == 'http'\n        ...\n\napp = App()\n</code></pre> <p>It's good practice for applications to raise an exception on scope types that they do not handle.</p> <p>The content of the <code>scope</code> argument, and the messages expected by <code>receive</code> and <code>send</code> depend on the protocol being used.</p> <p>The format for HTTP messages is described in the ASGI HTTP Message format.</p>"},{"location":"#http-scope","title":"HTTP Scope","text":"<p>An incoming HTTP request might have a connection <code>scope</code> like this:</p> <pre><code>{\n    'type': 'http',\n    'scheme': 'http',\n    'root_path': '',\n    'server': ('127.0.0.1', 8000),\n    'http_version': '1.1',\n    'method': 'GET',\n    'path': '/',\n    'headers': [\n        (b'host', b'127.0.0.1:8000'),\n        (b'user-agent', b'curl/7.51.0'),\n        (b'accept', b'*/*')\n    ]\n}\n</code></pre>"},{"location":"#http-messages","title":"HTTP Messages","text":"<p>The instance coroutine communicates back to the server by sending messages to the <code>send</code> coroutine.</p> <pre><code>await send({\n    'type': 'http.response.start',\n    'status': 200,\n    'headers': [\n        [b'content-type', b'text/plain'],\n    ]\n})\nawait send({\n    'type': 'http.response.body',\n    'body': b'Hello, world!',\n})\n</code></pre>"},{"location":"#requests-responses","title":"Requests &amp; responses","text":"<p>Here's an example that displays the method and path used in the incoming request:</p> <pre><code>async def app(scope, receive, send):\n    \"\"\"\n    Echo the method and path back in an HTTP response.\n    \"\"\"\n    assert scope['type'] == 'http'\n\n    body = f'Received {scope[\"method\"]} request to {scope[\"path\"]}'\n    await send({\n        'type': 'http.response.start',\n        'status': 200,\n        'headers': [\n            [b'content-type', b'text/plain'],\n        ]\n    })\n    await send({\n        'type': 'http.response.body',\n        'body': body.encode('utf-8'),\n    })\n</code></pre>"},{"location":"#reading-the-request-body","title":"Reading the request body","text":"<p>You can stream the request body without blocking the asyncio task pool, by fetching messages from the <code>receive</code> coroutine.</p> <pre><code>async def read_body(receive):\n    \"\"\"\n    Read and return the entire body from an incoming ASGI message.\n    \"\"\"\n    body = b''\n    more_body = True\n\n    while more_body:\n        message = await receive()\n        body += message.get('body', b'')\n        more_body = message.get('more_body', False)\n\n    return body\n\n\nasync def app(scope, receive, send):\n    \"\"\"\n    Echo the request body back in an HTTP response.\n    \"\"\"\n    body = await read_body(receive)\n    await send({\n        'type': 'http.response.start',\n        'status': 200,\n        'headers': [\n            (b'content-type', b'text/plain'),\n            (b'content-length', str(len(body)).encode())\n        ]\n    })\n    await send({\n        'type': 'http.response.body',\n        'body': body,\n    })\n</code></pre>"},{"location":"#streaming-responses","title":"Streaming responses","text":"<p>You can stream responses by sending multiple <code>http.response.body</code> messages to the <code>send</code> coroutine.</p> <pre><code>import asyncio\n\n\nasync def app(scope, receive, send):\n    \"\"\"\n    Send a slowly streaming HTTP response back to the client.\n    \"\"\"\n    await send({\n        'type': 'http.response.start',\n        'status': 200,\n        'headers': [\n            [b'content-type', b'text/plain'],\n        ]\n    })\n    for chunk in [b'Hello', b', ', b'world!']:\n        await send({\n            'type': 'http.response.body',\n            'body': chunk,\n            'more_body': True\n        })\n        await asyncio.sleep(1)\n    await send({\n        'type': 'http.response.body',\n        'body': b'',\n    })\n</code></pre>"},{"location":"#why-asgi","title":"Why ASGI?","text":"<p>Most well established Python Web frameworks started out as WSGI-based frameworks.</p> <p>WSGI applications are a single, synchronous callable that takes a request and returns a response. This doesn\u2019t allow for long-lived connections, like you get with long-poll HTTP or WebSocket connections, which WSGI doesn't support well.</p> <p>Having an async concurrency model also allows for options such as lightweight background tasks, and can be less of a limiting factor for endpoints that have long periods being blocked on network I/O such as dealing with slow HTTP requests.</p>"},{"location":"#alternative-asgi-servers","title":"Alternative ASGI servers","text":"<p>A strength of the ASGI protocol is that it decouples the server implementation from the application framework. This allows for an ecosystem of interoperating webservers and application frameworks.</p>"},{"location":"#daphne","title":"Daphne","text":"<p>The first ASGI server implementation, originally developed to power Django Channels, is the Daphne webserver.</p> <p>It is run widely in production, and supports HTTP/1.1, HTTP/2, and WebSockets.</p> <p>Any of the example applications given here can equally well be run using <code>daphne</code> instead.</p> <pre><code>pip install daphne\ndaphne app:App\n</code></pre>"},{"location":"#hypercorn","title":"Hypercorn","text":"<p>Hypercorn was initially part of the Quart web framework, before being separated out into a standalone ASGI server.</p> <p>Hypercorn supports HTTP/1.1, HTTP/2, HTTP/3 and WebSockets.</p> <pre><code>pip install hypercorn\nhypercorn app:App\n</code></pre>"},{"location":"#asgi-frameworks","title":"ASGI frameworks","text":"<p>You can use Uvicorn, Daphne, or Hypercorn to run any ASGI framework.</p> <p>For small services you can also write ASGI applications directly.</p>"},{"location":"#starlette","title":"Starlette","text":"<p>Starlette is a lightweight ASGI framework/toolkit.</p> <p>It is ideal for building high performance asyncio services, and supports both HTTP and WebSockets.</p>"},{"location":"#django-channels","title":"Django Channels","text":"<p>The ASGI specification was originally designed for use with Django Channels.</p> <p>Channels is a little different to other ASGI frameworks in that it provides an asynchronous frontend onto a threaded-framework backend. It allows Django to support WebSockets, background tasks, and long-running connections, with application code still running in a standard threaded context.</p>"},{"location":"#quart","title":"Quart","text":"<p>Quart is a Flask-like ASGI web framework.</p>"},{"location":"#fastapi","title":"FastAPI","text":"<p>FastAPI is an API framework based on Starlette and Pydantic, heavily inspired by previous server versions of APIStar.</p> <p>You write your API function parameters with Python 3.6+ type declarations and get automatic data conversion, data validation, OpenAPI schemas (with JSON Schemas) and interactive API documentation UIs.</p>"},{"location":"#blacksheep","title":"BlackSheep","text":"<p>BlackSheep is a web framework based on ASGI, inspired by Flask and ASP.NET Core.</p> <p>Its most distinctive features are built-in support for dependency injection, automatic binding of parameters by request handler's type annotations, and automatic generation of OpenAPI documentation and Swagger UI.</p>"},{"location":"#falcon","title":"Falcon","text":"<p>Falcon is a minimalist REST and app backend framework for Python, with a focus on reliability, correctness, and performance at scale.</p>"},{"location":"#muffin","title":"Muffin","text":"<p>Muffin is a fast, lightweight and asynchronous ASGI web-framework for Python 3.</p>"},{"location":"#litestar","title":"Litestar","text":"<p>Litestar is a powerful, lightweight and flexible ASGI framework.</p> <p>It includes everything that's needed to build modern APIs - from data serialization and validation to websockets, ORM integration, session management, authentication and more.</p>"},{"location":"#panther","title":"Panther","text":"<p>Panther is a fast &amp; friendly web framework for building async APIs with Python 3.10+.</p> <p>It has built-in Document-oriented Database, Caching System, Authentication and Permission Classes, Visual API Monitoring and also supports Websocket, Throttling, Middlewares.</p>"},{"location":"contributing/","title":"Contributing","text":"<p>Thank you for being interested in contributing to Uvicorn. There are many ways you can contribute to the project:</p> <ul> <li>Using Uvicorn on your stack and reporting bugs/issues you find</li> <li>Implementing new features and fixing bugs</li> <li>Review Pull Requests of others</li> <li>Write documentation</li> <li>Participate in discussions</li> </ul>"},{"location":"contributing/#reporting-bugs-issues-or-feature-requests","title":"Reporting Bugs, Issues or Feature Requests","text":"<p>Found something that Uvicorn should support? Stumbled upon some unexpected behaviour? Need a missing functionality?</p> <p>Contributions should generally start out from a previous discussion. You can reach out someone at the community chat or at the github discussions tab.</p> <p>When creating a new topic in the discussions tab, possible bugs may be raised as a \"Potential Issue\" discussion, feature requests may be raised as an \"Ideas\" discussion. We can then determine if the discussion needs to be escalated into an \"Issue\" or not, or if we'd consider a pull request.</p> <p>Try to be more descriptive as you can and in case of a bug report, provide as much information as possible like:</p> <ul> <li>OS platform</li> <li>Python version</li> <li>Installed dependencies and versions (<code>python -m pip freeze</code>)</li> <li>Code snippet</li> <li>Error traceback</li> </ul> <p>You should always try to reduce any examples to the simplest possible case that demonstrates the issue.</p> <p>Some possibly useful tips for narrowing down potential issues...</p> <ul> <li>Does the issue exist with a specific supervisor like <code>Multiprocess</code> or more than one?</li> <li>Does the issue exist on asgi, or wsgi, or both?</li> <li>Are you running Uvicorn in conjunction with Gunicorn, others, or standalone?</li> </ul>"},{"location":"contributing/#development","title":"Development","text":"<p>To start developing Uvicorn create a fork of the Uvicorn repository on GitHub.</p> <p>Then clone your fork with the following command replacing <code>YOUR-USERNAME</code> with your GitHub username:</p> <pre><code>$ git clone https://github.com/YOUR-USERNAME/uvicorn\n</code></pre> <p>You can now install the project and its dependencies using:</p> <pre><code>$ cd uvicorn\n$ scripts/install\n</code></pre>"},{"location":"contributing/#testing-and-linting","title":"Testing and Linting","text":"<p>We use custom shell scripts to automate testing, linting, and documentation building workflow.</p> <p>To run the tests, use:</p> <pre><code>$ scripts/test\n</code></pre> <p>Any additional arguments will be passed to <code>pytest</code>. See the pytest documentation for more information.</p> <p>For example, to run a single test script:</p> <pre><code>$ scripts/test tests/test_cli.py\n</code></pre> <p>To run the code auto-formatting:</p> <pre><code>$ scripts/lint\n</code></pre> <p>Lastly, to run code checks separately (they are also run as part of <code>scripts/test</code>), run:</p> <pre><code>$ scripts/check\n</code></pre>"},{"location":"contributing/#documenting","title":"Documenting","text":"<p>Documentation pages are located under the <code>docs/</code> folder.</p> <p>To run the documentation site locally (useful for previewing changes), use:</p> <pre><code>$ scripts/docs serve\n</code></pre>"},{"location":"contributing/#resolving-build-ci-failures","title":"Resolving Build / CI Failures","text":"<p>Once you've submitted your pull request, the test suite will automatically run, and the results will show up in GitHub. If the test suite fails, you'll want to click through to the \"Details\" link, and try to identify why the test suite failed.</p> <p> </p> <p>Here are some common ways the test suite can fail:</p>"},{"location":"contributing/#check-job-failed","title":"Check Job Failed","text":"<p>This job failing means there is either a code formatting issue or type-annotation issue. You can look at the job output to figure out why it's failed or within a shell run:</p> <pre><code>$ scripts/check\n</code></pre> <p>It may be worth it to run <code>$ scripts/lint</code> to attempt auto-formatting the code and if that job succeeds commit the changes.</p>"},{"location":"contributing/#docs-job-failed","title":"Docs Job Failed","text":"<p>This job failing means the documentation failed to build. This can happen for a variety of reasons like invalid markdown or missing configuration within <code>mkdocs.yml</code>.</p>"},{"location":"contributing/#python-3x-job-failed","title":"Python 3.X Job Failed","text":"<p>This job failing means the unit tests failed or not all code paths are covered by unit tests.</p> <p>If tests are failing you will see this message under the coverage report:</p> <p><code>=== 1 failed, 354 passed, 1 skipped, 1 xfailed in 37.08s ===</code></p> <p>If tests succeed but coverage doesn't reach 100%, you will see this message under the coverage report:</p> <p><code>Coverage failure: total of 98 is less than fail-under=100</code></p>"},{"location":"contributing/#releasing","title":"Releasing","text":"<p>This section is targeted at Uvicorn maintainers.</p> <p>Before releasing a new version, create a pull request that includes:</p> <ul> <li>An update to the changelog:<ul> <li>We follow the format from keepachangelog.</li> <li>Compare <code>master</code> with the tag of the latest release, and list all entries that are of interest to our users:<ul> <li>Things that must go in the changelog: added, changed, deprecated or removed features, and bug fixes.</li> <li>Things that should not go in the changelog: changes to documentation, tests or tooling.</li> <li>Try sorting entries in descending order of impact / importance.</li> <li>Keep it concise and to-the-point. \ud83c\udfaf</li> </ul> </li> </ul> </li> <li>A version bump: see <code>__init__.py</code>.</li> </ul> <p>For an example, see #1006.</p> <p>Once the release PR is merged, create a new release including:</p> <ul> <li>Tag version like <code>0.13.3</code>.</li> <li>Release title <code>Version 0.13.3</code></li> <li>Description copied from the changelog.</li> </ul> <p>Once created this release will be automatically uploaded to PyPI.</p> <p>If something goes wrong with the PyPI job the release can be published using the <code>scripts/publish</code> script.</p>"},{"location":"release-notes/","title":"Release Notes","text":""},{"location":"release-notes/#toc_depth-2","title":"toc_depth: 2","text":""},{"location":"release-notes/#0350-june-28-2025","title":"0.35.0 (June 28, 2025)","text":""},{"location":"release-notes/#added","title":"Added","text":"<ul> <li>Add <code>WebSocketsSansIOProtocol</code> (#2540)</li> </ul>"},{"location":"release-notes/#changed","title":"Changed","text":"<ul> <li>Refine help message for option <code>--proxy-headers</code> (#2653)</li> </ul>"},{"location":"release-notes/#0343-june-1-2025","title":"0.34.3 (June 1, 2025)","text":""},{"location":"release-notes/#fixed","title":"Fixed","text":"<ul> <li>Don't include <code>cwd()</code> when non-empty <code>--reload-dirs</code> is passed (#2598)</li> <li>Apply <code>get_client_addr</code> formatting to WebSocket logging (#2636)</li> </ul>"},{"location":"release-notes/#0342-april-19-2025","title":"0.34.2 (April 19, 2025)","text":""},{"location":"release-notes/#fixed_1","title":"Fixed","text":"<ul> <li>Flush stdout buffer on Windows to trigger reload (#2604)</li> </ul>"},{"location":"release-notes/#0341-april-13-2025","title":"0.34.1 (April 13, 2025)","text":""},{"location":"release-notes/#deprecated","title":"Deprecated","text":"<ul> <li>Deprecate <code>ServerState</code> in the main module (#2581)</li> </ul>"},{"location":"release-notes/#0340-december-15-2024","title":"0.34.0 (December 15, 2024)","text":""},{"location":"release-notes/#added_1","title":"Added","text":"<ul> <li>Add <code>content-length</code> to 500 response in <code>wsproto</code> implementation (#2542)</li> </ul>"},{"location":"release-notes/#removed","title":"Removed","text":"<ul> <li>Drop support for Python 3.8 (#2543)</li> </ul>"},{"location":"release-notes/#0330-december-14-2024","title":"0.33.0 (December 14, 2024)","text":""},{"location":"release-notes/#removed_1","title":"Removed","text":"<ul> <li>Remove <code>WatchGod</code> support for <code>--reload</code> (#2536)</li> </ul>"},{"location":"release-notes/#0321-november-20-2024","title":"0.32.1 (November 20, 2024)","text":""},{"location":"release-notes/#fixed_2","title":"Fixed","text":"<ul> <li>Drop ASGI spec version to 2.3 on HTTP scope (#2513)</li> <li>Enable httptools lenient data on <code>httptools &gt;= 0.6.3</code> (#2488)</li> </ul>"},{"location":"release-notes/#0320-october-15-2024","title":"0.32.0 (October 15, 2024)","text":""},{"location":"release-notes/#added_2","title":"Added","text":"<ul> <li>Officially support Python 3.13 (#2482)</li> <li>Warn when <code>max_request_limit</code> is exceeded (#2430)</li> </ul>"},{"location":"release-notes/#0311-october-9-2024","title":"0.31.1 (October 9, 2024)","text":""},{"location":"release-notes/#fixed_3","title":"Fixed","text":"<ul> <li>Support WebSockets 0.13.1 (#2471)</li> <li>Restore support for <code>[*]</code> in trusted hosts (#2480)</li> <li>Add <code>PathLike[str]</code> type hint for <code>ssl_keyfile</code> (#2481)</li> </ul>"},{"location":"release-notes/#0310-september-27-2024","title":"0.31.0 (September 27, 2024)","text":""},{"location":"release-notes/#added_3","title":"Added","text":"<p>Improve <code>ProxyHeadersMiddleware</code> (#2468) and (#2231):</p> <ul> <li>Fix the host for requests from clients running on the proxy server itself.</li> <li>Fallback to host that was already set for empty x-forwarded-for headers.</li> <li>Also allow to specify IP Networks as trusted hosts. This greatly simplifies deployments   on docker swarm/kubernetes, where the reverse proxy might have a dynamic IP.<ul> <li>This includes support for IPv6 Address/Networks.</li> </ul> </li> </ul>"},{"location":"release-notes/#0306-august-13-2024","title":"0.30.6 (August 13, 2024)","text":""},{"location":"release-notes/#fixed_4","title":"Fixed","text":"<ul> <li>Don't warn when upgrade is not WebSocket and depedencies are installed (#2360)</li> </ul>"},{"location":"release-notes/#0305-august-2-2024","title":"0.30.5 (August 2, 2024)","text":""},{"location":"release-notes/#fixed_5","title":"Fixed","text":"<ul> <li>Don't close connection before receiving body on H11 (#2408)</li> </ul>"},{"location":"release-notes/#0304-july-31-2024","title":"0.30.4 (July 31, 2024)","text":""},{"location":"release-notes/#fixed_6","title":"Fixed","text":"<ul> <li>Close connection when <code>h11</code> sets client state to <code>MUST_CLOSE</code> (#2375)</li> </ul>"},{"location":"release-notes/#0303-july-20-2024","title":"0.30.3 (July 20, 2024)","text":""},{"location":"release-notes/#fixed_7","title":"Fixed","text":"<ul> <li>Suppress <code>KeyboardInterrupt</code> from CLI and programmatic usage (#2384)</li> <li><code>ClientDisconnect</code> inherits from <code>OSError</code> instead of <code>IOError</code> (#2393)</li> </ul>"},{"location":"release-notes/#0302-july-20-2024","title":"0.30.2 (July 20, 2024)","text":""},{"location":"release-notes/#added_4","title":"Added","text":"<ul> <li>Add <code>reason</code> support to <code>websocket.disconnect</code> event (#2324)</li> </ul>"},{"location":"release-notes/#fixed_8","title":"Fixed","text":"<ul> <li>Iterate subprocesses in-place on the process manager (#2373)</li> </ul>"},{"location":"release-notes/#0301-june-2-2024","title":"0.30.1 (June 2, 2024)","text":""},{"location":"release-notes/#fixed_9","title":"Fixed","text":"<ul> <li>Allow horizontal tabs <code>\\t</code> in response header values (#2345)</li> </ul>"},{"location":"release-notes/#0300-may-28-2024","title":"0.30.0 (May 28, 2024)","text":""},{"location":"release-notes/#added_5","title":"Added","text":"<ul> <li>New multiprocess manager (#2183)</li> <li>Allow <code>ConfigParser</code> or a <code>io.IO[Any]</code> on <code>log_config</code> (#1976)</li> </ul>"},{"location":"release-notes/#fixed_10","title":"Fixed","text":"<ul> <li>Suppress side-effects of signal propagation (#2317)</li> <li>Send <code>content-length</code> header on 5xx (#2304)</li> </ul>"},{"location":"release-notes/#deprecated_1","title":"Deprecated","text":"<ul> <li>Deprecate the <code>uvicorn.workers</code> module (#2302)</li> </ul>"},{"location":"release-notes/#0290-march-19-2024","title":"0.29.0 (March 19, 2024)","text":""},{"location":"release-notes/#added_6","title":"Added","text":"<ul> <li>Cooperative signal handling (#1600)</li> </ul>"},{"location":"release-notes/#0281-march-19-2024","title":"0.28.1 (March 19, 2024)","text":""},{"location":"release-notes/#fixed_11","title":"Fixed","text":"<ul> <li>Revert raise <code>ClientDisconnected</code> on HTTP (#2276)</li> </ul>"},{"location":"release-notes/#0280-march-9-2024","title":"0.28.0 (March 9, 2024)","text":""},{"location":"release-notes/#added_7","title":"Added","text":"<ul> <li>Raise <code>ClientDisconnected</code> on <code>send()</code> when client disconnected (#2220)</li> </ul>"},{"location":"release-notes/#fixed_12","title":"Fixed","text":"<ul> <li>Except <code>AttributeError</code> on <code>sys.stdin.fileno()</code> for Windows IIS10 (#1947)</li> <li>Use <code>X-Forwarded-Proto</code> for WebSockets scheme when the proxy provides it (#2258)</li> </ul>"},{"location":"release-notes/#0271-february-10-2024","title":"0.27.1 (February 10, 2024)","text":"<ul> <li>Fix spurious LocalProtocolError errors when processing pipelined requests (#2243)</li> </ul>"},{"location":"release-notes/#0270post1-january-29-2024","title":"0.27.0.post1 (January 29, 2024)","text":""},{"location":"release-notes/#fixed_13","title":"Fixed","text":"<ul> <li>Fix nav overrides for newer version of Mkdocs Material (#2233)</li> </ul>"},{"location":"release-notes/#0270-january-22-2024","title":"0.27.0 (January 22, 2024)","text":""},{"location":"release-notes/#added_8","title":"Added","text":"<ul> <li>Raise <code>ClientDisconnect(IOError)</code> on <code>send()</code> when client disconnected (#2218)</li> <li>Bump ASGI WebSocket spec version to 2.4 (#2221)</li> </ul>"},{"location":"release-notes/#0260-january-16-2024","title":"0.26.0 (January 16, 2024)","text":""},{"location":"release-notes/#changed_1","title":"Changed","text":"<ul> <li>Update <code>--root-path</code> to include the root path prefix in the full ASGI <code>path</code> as per the ASGI spec (#2213)</li> <li>Use <code>__future__.annotations</code> on some internal modules (#2199)</li> </ul>"},{"location":"release-notes/#0250-december-17-2023","title":"0.25.0 (December 17, 2023)","text":""},{"location":"release-notes/#added_9","title":"Added","text":"<ul> <li>Support the WebSocket Denial Response ASGI extension (#1916)</li> </ul>"},{"location":"release-notes/#fixed_14","title":"Fixed","text":"<ul> <li>Allow explicit hidden file paths on <code>--reload-include</code> (#2176)</li> <li>Properly annotate <code>uvicorn.run()</code> (#2158)</li> </ul>"},{"location":"release-notes/#0240post1-november-6-2023","title":"0.24.0.post1 (November 6, 2023)","text":""},{"location":"release-notes/#fixed_15","title":"Fixed","text":"<ul> <li>Revert mkdocs-material from 9.1.21 to 9.2.6 (#2148)</li> </ul>"},{"location":"release-notes/#0240-november-4-2023","title":"0.24.0 (November 4, 2023)","text":""},{"location":"release-notes/#added_10","title":"Added","text":"<ul> <li>Support Python 3.12 (#2145)</li> <li>Allow setting <code>app</code> via environment variable <code>UVICORN_APP</code> (#2106)</li> </ul>"},{"location":"release-notes/#0232-july-31-2023","title":"0.23.2 (July 31, 2023)","text":""},{"location":"release-notes/#fixed_16","title":"Fixed","text":"<ul> <li>Maintain the same behavior of <code>websockets</code> from 10.4 on 11.0 (#2061)</li> </ul>"},{"location":"release-notes/#0231-july-18-2023","title":"0.23.1 (July 18, 2023)","text":""},{"location":"release-notes/#fixed_17","title":"Fixed","text":"<ul> <li>Add <code>typing_extensions</code> for Python 3.10 and lower (#2053)</li> </ul>"},{"location":"release-notes/#0230-july-10-2023","title":"0.23.0 (July 10, 2023)","text":""},{"location":"release-notes/#added_11","title":"Added","text":"<ul> <li>Add <code>--ws-max-queue</code> parameter WebSockets (#2033)</li> </ul>"},{"location":"release-notes/#removed_2","title":"Removed","text":"<ul> <li>Drop support for Python 3.7 (#1996)</li> <li>Remove <code>asgiref</code> as typing dependency (#1999)</li> </ul>"},{"location":"release-notes/#fixed_18","title":"Fixed","text":"<ul> <li>Set <code>scope[\"scheme\"]</code> to <code>ws</code> or <code>wss</code> instead of <code>http</code> or <code>https</code> on <code>ProxyHeadersMiddleware</code> for WebSockets (#2043)</li> </ul>"},{"location":"release-notes/#changed_2","title":"Changed","text":"<ul> <li>Raise <code>ImportError</code> on circular import (#2040)</li> <li>Use <code>logger.getEffectiveLevel()</code> instead of <code>logger.level</code> to check if log level is <code>TRACE</code> (#1966)</li> </ul>"},{"location":"release-notes/#0220-april-28-2023","title":"0.22.0 (April 28, 2023)","text":""},{"location":"release-notes/#added_12","title":"Added","text":"<ul> <li>Add <code>--timeout-graceful-shutdown</code> parameter (#1950)</li> <li>Handle <code>SIGBREAK</code> on Windows (#1909)</li> </ul>"},{"location":"release-notes/#fixed_19","title":"Fixed","text":"<ul> <li>Shutdown event is now being triggered on Windows when using hot reload (#1584)</li> <li><code>--reload-delay</code> is effectively used on the <code>watchfiles</code> reloader (#1930)</li> </ul>"},{"location":"release-notes/#0211-march-16-2023","title":"0.21.1 (March 16, 2023)","text":""},{"location":"release-notes/#fixed_20","title":"Fixed","text":"<ul> <li>Reset lifespan state on each request (#1903)</li> </ul>"},{"location":"release-notes/#0210-march-9-2023","title":"0.21.0 (March 9, 2023)","text":""},{"location":"release-notes/#added_13","title":"Added","text":"<ul> <li>Introduce lifespan state (#1818)</li> <li>Allow headers to be sent as iterables on H11 implementation (#1782)</li> <li>Improve discoverability when --port=0 is used (#1890)</li> </ul>"},{"location":"release-notes/#changed_3","title":"Changed","text":"<ul> <li>Avoid importing <code>h11</code> and <code>pyyaml</code> when not needed to improve import time (#1846)</li> <li>Replace current native <code>WSGIMiddleware</code> implementation by <code>a2wsgi</code> (#1825)</li> <li>Change default <code>--app-dir</code> from \".\" (dot) to \"\" (empty string) (#1835)</li> </ul>"},{"location":"release-notes/#fixed_21","title":"Fixed","text":"<ul> <li>Send code 1012 on shutdown for WebSockets (#1816)</li> <li>Use <code>surrogateescape</code> to encode headers on <code>websockets</code> implementation (#1005)</li> <li>Fix warning message on reload failure (#1784)</li> </ul>"},{"location":"release-notes/#0200-november-20-2022","title":"0.20.0 (November 20, 2022)","text":""},{"location":"release-notes/#added_14","title":"Added","text":"<ul> <li>Check if handshake is completed before sending frame on <code>wsproto</code> shutdown (#1737)</li> <li>Add default headers to WebSockets implementations (#1606 &amp; #1747)</li> <li>Warn user when <code>reload</code> and <code>workers</code> flag are used together (#1731)</li> </ul>"},{"location":"release-notes/#fixed_22","title":"Fixed","text":"<ul> <li>Use correct <code>WebSocket</code> error codes on <code>close</code> (#1753)</li> <li>Send disconnect event on connection lost for <code>wsproto</code> (#996)</li> <li>Add <code>SIGQUIT</code> handler to <code>UvicornWorker</code> (#1710)</li> <li>Fix crash on exist with \"--uds\" if socket doesn't exist (#1725)</li> <li>Annotate <code>CONFIG_KWARGS</code> in <code>UvicornWorker</code> class (#1746)</li> </ul>"},{"location":"release-notes/#removed_3","title":"Removed","text":"<ul> <li>Remove conditional on <code>RemoteProtocolError.event_hint</code> on <code>wsproto</code> (#1486)</li> <li>Remove unused <code>handle_no_connect</code> on <code>wsproto</code> implementation (#1759)</li> </ul>"},{"location":"release-notes/#0190-october-19-2022","title":"0.19.0 (October 19, 2022)","text":""},{"location":"release-notes/#added_15","title":"Added","text":"<ul> <li>Support Python 3.11 (#1652)</li> <li>Bump minimal <code>httptools</code> version to <code>0.5.0</code> (#1645)</li> <li>Ignore HTTP/2 upgrade and optionally ignore WebSocket upgrade (#1661)</li> <li>Add <code>py.typed</code> to comply with PEP 561 (#1687)</li> </ul>"},{"location":"release-notes/#fixed_23","title":"Fixed","text":"<ul> <li>Set <code>propagate</code> to <code>False</code> on \"uvicorn\" logger (#1288)</li> <li>USR1 signal is now handled correctly on <code>UvicornWorker</code>. (#1565)</li> <li>Use path with query string on <code>WebSockets</code> logs (#1385)</li> <li>Fix behavior on which \"Date\" headers were not updated on the same connection (#1706)</li> </ul>"},{"location":"release-notes/#removed_4","title":"Removed","text":"<ul> <li>Remove the <code>--debug</code> flag (#1640)</li> <li>Remove the <code>DebugMiddleware</code> (#1697)</li> </ul>"},{"location":"release-notes/#0183-august-24-2022","title":"0.18.3 (August 24, 2022)","text":""},{"location":"release-notes/#fixed_24","title":"Fixed","text":"<ul> <li>Remove cyclic references on HTTP implementations. (#1604)</li> </ul>"},{"location":"release-notes/#changed_4","title":"Changed","text":"<ul> <li><code>reload_delay</code> default changed from <code>None</code> to <code>0.25</code> on <code>uvicorn.run()</code> and <code>Config</code>. <code>None</code> is not an acceptable value anymore. (#1545)</li> </ul>"},{"location":"release-notes/#0182-june-27-2022","title":"0.18.2 (June 27, 2022)","text":""},{"location":"release-notes/#fixed_25","title":"Fixed","text":"<ul> <li>Add default <code>log_config</code> on <code>uvicorn.run()</code> (#1541)</li> <li>Revert <code>logging</code> file name modification (#1543)</li> </ul>"},{"location":"release-notes/#0181-june-23-2022","title":"0.18.1 (June 23, 2022)","text":""},{"location":"release-notes/#fixed_26","title":"Fixed","text":"<ul> <li>Use <code>DEFAULT_MAX_INCOMPLETE_EVENT_SIZE</code> as default to <code>h11_max_incomplete_event_size</code> on the CLI (#1534)</li> </ul>"},{"location":"release-notes/#0180-june-23-2022","title":"0.18.0 (June 23, 2022)","text":""},{"location":"release-notes/#added_16","title":"Added","text":"<ul> <li>The <code>reload</code> flag prioritizes <code>watchfiles</code> instead of the deprecated <code>watchgod</code> (#1437)</li> <li>Annotate <code>uvicorn.run()</code> function (#1423)</li> <li>Allow configuring <code>max_incomplete_event_size</code> for <code>h11</code> implementation (#1514)</li> </ul>"},{"location":"release-notes/#removed_5","title":"Removed","text":"<ul> <li>Remove <code>asgiref</code> dependency (#1532)</li> </ul>"},{"location":"release-notes/#fixed_27","title":"Fixed","text":"<ul> <li>Turn <code>raw_path</code> into bytes on both websockets implementations (#1487)</li> <li>Revert log exception traceback in case of invalid HTTP request (#1518)</li> <li>Set <code>asyncio.WindowsSelectorEventLoopPolicy()</code> when using multiple workers to avoid \"WinError 87\" (#1454)</li> </ul>"},{"location":"release-notes/#0176-march-11-2022","title":"0.17.6 (March 11, 2022)","text":""},{"location":"release-notes/#changed_5","title":"Changed","text":"<ul> <li>Change <code>httptools</code> range to <code>&gt;=0.4.0</code> (#1400)</li> </ul>"},{"location":"release-notes/#0175-february-16-2022","title":"0.17.5 (February 16, 2022)","text":""},{"location":"release-notes/#fixed_28","title":"Fixed","text":"<ul> <li>Fix case where url is fragmented in httptools protocol (#1263)</li> <li>Fix WSGI middleware not to explode quadratically in the case of a larger body (#1329)</li> </ul>"},{"location":"release-notes/#changed_6","title":"Changed","text":"<ul> <li>Send HTTP 400 response for invalid request (#1352)</li> </ul>"},{"location":"release-notes/#0174-february-4-2022","title":"0.17.4 (February 4, 2022)","text":""},{"location":"release-notes/#fixed_29","title":"Fixed","text":"<ul> <li>Replace <code>create_server</code> by <code>create_unix_server</code> (#1362)</li> </ul>"},{"location":"release-notes/#0173-february-3-2022","title":"0.17.3 (February 3, 2022)","text":""},{"location":"release-notes/#fixed_30","title":"Fixed","text":"<ul> <li>Drop wsproto version checking. (#1359)</li> </ul>"},{"location":"release-notes/#0172-february-3-2022","title":"0.17.2 (February 3, 2022)","text":""},{"location":"release-notes/#fixed_31","title":"Fixed","text":"<ul> <li>Revert #1332. While trying to solve the memory leak, it introduced an issue (#1345) when the server receives big chunks of data using the <code>httptools</code> implementation. (#1354)</li> <li>Revert stream interface changes. This was introduced on 0.14.0, and caused an issue (#1226), which caused a memory leak when sending TCP pings. (#1355)</li> <li>Fix wsproto version check expression (#1342)</li> </ul>"},{"location":"release-notes/#0171-january-28-2022","title":"0.17.1 (January 28, 2022)","text":""},{"location":"release-notes/#fixed_32","title":"Fixed","text":"<ul> <li>Move all data handling logic to protocol and ensure connection is closed. (#1332)</li> <li>Change <code>spec_version</code> field from \"2.1\" to \"2.3\", as Uvicorn is compliant with that version of the ASGI specifications. (#1337)</li> </ul>"},{"location":"release-notes/#0170post1-january-24-2022","title":"0.17.0.post1 (January 24, 2022)","text":""},{"location":"release-notes/#fixed_33","title":"Fixed","text":"<ul> <li>Add the <code>python_requires</code> version specifier (#1328)</li> </ul>"},{"location":"release-notes/#0170-january-14-2022","title":"0.17.0 (January 14, 2022)","text":""},{"location":"release-notes/#added_17","title":"Added","text":"<ul> <li>Allow configurable websocket per-message-deflate setting (#1300)</li> <li>Support extra_headers for WS accept message (#1293)</li> <li>Add missing http version on websockets scope (#1309)</li> </ul>"},{"location":"release-notes/#fixedremoved","title":"Fixed/Removed","text":"<ul> <li>Drop Python 3.6 support (#1261)</li> <li>Fix reload process behavior when exception is raised (#1313)</li> <li>Remove <code>root_path</code> from logs (#1294)</li> </ul>"},{"location":"release-notes/#0160-december-8-2021","title":"0.16.0 (December 8, 2021)","text":""},{"location":"release-notes/#added_18","title":"Added","text":"<ul> <li>Enable read of uvicorn settings from environment variables (#1279)</li> <li>Bump <code>websockets</code> to 10.0. (#1180)</li> <li>Ensure non-zero exit code when startup fails (#1278)</li> <li>Increase <code>httptools</code> version range from \"==0.2.*\" to \"&gt;=0.2.0,&lt;0.4.0\". (#1243)</li> <li>Override default asyncio event loop with reload only on Windows (#1257)</li> <li>Replace <code>HttpToolsProtocol.pipeline</code> type from <code>list</code> to <code>deque</code>. (#1213)</li> <li>Replace <code>WSGIResponder.send_queue</code> type from <code>list</code> to <code>deque</code>. (#1214)</li> </ul>"},{"location":"release-notes/#fixed_34","title":"Fixed","text":"<ul> <li>Main process exit after startup failure on reloader classes (#1177)</li> <li>Fix the need of <code>httptools</code> on minimal installation (#1135)</li> <li>Fix ping parameters annotation in Config class (#1127)</li> </ul>"},{"location":"release-notes/#0150-august-13-2021","title":"0.15.0 (August 13, 2021)","text":""},{"location":"release-notes/#added_19","title":"Added","text":"<ul> <li>Change reload to be configurable with glob patterns. Currently only <code>.py</code> files are watched, which is different from the previous default behavior. (#820)</li> <li>Add Python 3.10-rc.1 support. Now the server uses <code>asyncio.run</code> which will: start a fresh asyncio event loop, on shutdown cancel any background tasks rather than aborting them, <code>aexit</code> any remaining async generators, and shutdown the default <code>ThreadPoolExecutor</code>. (#1070)</li> <li>Exit with status 3 when worker starts failed (#1077)</li> <li>Add option to set websocket ping interval and timeout (#1048)</li> <li>Adapt bind_socket to make it usable with multiple processes (#1009)</li> <li>Add existence check to the reload directory(ies) (#1089)</li> <li>Add missing trace log for websocket protocols (#1083)</li> <li>Support disabling default Server and Date headers (#818)</li> </ul>"},{"location":"release-notes/#changed_7","title":"Changed","text":"<ul> <li>Add PEP440 compliant version of click (#1099)</li> <li>Bump asgiref to 3.4.0 (#1100)</li> </ul>"},{"location":"release-notes/#fixed_35","title":"Fixed","text":"<ul> <li>When receiving a <code>SIGTERM</code> supervisors now terminate their processes before joining them (#1069)</li> <li>Fix <code>httptools</code> range to <code>&gt;=0.4.0</code> (#1400)</li> </ul>"},{"location":"release-notes/#0140-june-1-2021","title":"0.14.0 (June 1, 2021)","text":""},{"location":"release-notes/#added_20","title":"Added","text":"<ul> <li>Defaults ws max_size on server to 16MB (#995)</li> <li>Improve user feedback if no ws library installed (#926 and #1023)</li> <li>Support 'reason' field in 'websocket.close' messages (#957)</li> <li>Implemented lifespan.shutdown.failed (#755)</li> </ul>"},{"location":"release-notes/#changed_8","title":"Changed","text":"<ul> <li>Upgraded websockets requirements (#1065)</li> <li>Switch to asyncio streams API (#869)</li> <li>Update httptools from 0.1. to 0.2. (#1024)</li> <li>Allow Click 8.0, refs #1016 (#1042)</li> <li>Add search for a trusted host in ProxyHeadersMiddleware (#591)</li> <li>Up wsproto to 1.0.0 (#892)</li> </ul>"},{"location":"release-notes/#fixed_36","title":"Fixed","text":"<ul> <li>Force reload_dirs to be a list (#978)</li> <li>Fix gunicorn worker not running if extras not installed (#901)</li> <li>Fix socket port 0 (#975)</li> <li>Prevent garbage collection of main lifespan task (#972)</li> </ul>"},{"location":"release-notes/#0134-february-20-2021","title":"0.13.4 (February 20, 2021)","text":""},{"location":"release-notes/#fixed_37","title":"Fixed","text":"<ul> <li>Fixed wsgi middleware PATH_INFO encoding (#962)</li> <li>Fixed uvloop dependency  (#952) then (#959)</li> <li>Relax watchgod up bound (#946)</li> <li>Return 'connection: close' header in response (#721)</li> </ul>"},{"location":"release-notes/#added_21","title":"Added","text":"<ul> <li>Docs: Nginx + websockets (#948)</li> <li>Document the default value of 1 for workers (#940) (#943)</li> <li>Enabled permessage-deflate extension in websockets (#764)</li> </ul>"},{"location":"release-notes/#0133-december-29-2020","title":"0.13.3 (December 29, 2020)","text":""},{"location":"release-notes/#fixed_38","title":"Fixed","text":"<ul> <li>Prevent swallowing of return codes from <code>subprocess</code> when running with Gunicorn by properly resetting signals. (#895)</li> <li>Tweak detection of app factories to be more robust. A warning is now logged when passing a factory without the <code>--factory</code> flag. (#914)</li> <li>Properly clean tasks when handshake is aborted when running with <code>--ws websockets</code>. (#921)</li> </ul>"},{"location":"release-notes/#0132-december-12-2020","title":"0.13.2 (December 12, 2020)","text":""},{"location":"release-notes/#fixed_39","title":"Fixed","text":"<ul> <li>Log full exception traceback in case of invalid HTTP request. (#886 and #888)</li> </ul>"},{"location":"release-notes/#0131-december-12-2020","title":"0.13.1 (December 12, 2020)","text":""},{"location":"release-notes/#fixed_40","title":"Fixed","text":"<ul> <li>Prevent exceptions when the ASGI application rejects a connection during the WebSocket handshake, when running on both <code>--ws wsproto</code> or <code>--ws websockets</code>. (#704 and #881)</li> <li>Ensure connection <code>scope</code> doesn't leak in logs when using JSON log formatters. (#859 and #884)</li> </ul>"},{"location":"release-notes/#0130-december-8-2020","title":"0.13.0 (December 8, 2020)","text":""},{"location":"release-notes/#added_22","title":"Added","text":"<ul> <li>Add <code>--factory</code> flag to support factory-style application imports. (#875)</li> <li>Skip installation of signal handlers when not in the main thread. Allows using <code>Server</code> in multithreaded contexts without having to override <code>.install_signal_handlers()</code>. (#871)</li> </ul>"},{"location":"release-notes/#0123-november-21-2020","title":"0.12.3 (November 21, 2020)","text":""},{"location":"release-notes/#fixed_41","title":"Fixed","text":"<ul> <li>Fix race condition that leads Quart to hang with uvicorn (#848)</li> <li>Use latin1 when decoding X-Forwarded-* headers (#701)</li> <li>Rework IPv6 support (#837)</li> <li>Cancel old keepalive-trigger before setting new one. (#832)</li> </ul>"},{"location":"release-notes/#0122-october-19-2020","title":"0.12.2 (October 19, 2020)","text":""},{"location":"release-notes/#added_23","title":"Added","text":"<ul> <li>Adding ability to decrypt ssl key file (#808)</li> <li>Support .yml log config files (#799)</li> <li>Added python 3.9 support (#804)</li> </ul>"},{"location":"release-notes/#fixed_42","title":"Fixed","text":"<ul> <li>Fixes watchgod with common prefixes (#817)</li> <li>Fix reload with ipv6 host (#803)</li> <li>Added cli support for headers containing colon (#813)</li> <li>Sharing socket across workers on windows (#802)</li> <li>Note the need to configure trusted \"ips\" when using unix sockets (#796)</li> </ul>"},{"location":"release-notes/#0121-september-30-2020","title":"0.12.1 (September 30, 2020)","text":""},{"location":"release-notes/#changed_9","title":"Changed","text":"<ul> <li>Pinning h11 and python-dotenv to min versions (#789)</li> <li>Get docs/index.md in sync with README.md (#784)</li> </ul>"},{"location":"release-notes/#fixed_43","title":"Fixed","text":"<ul> <li>Improve changelog by pointing out breaking changes (#792)</li> </ul>"},{"location":"release-notes/#0120-september-28-2020","title":"0.12.0 (September 28, 2020)","text":""},{"location":"release-notes/#added_24","title":"Added","text":"<ul> <li>Make reload delay configurable (#774)</li> <li>Upgrade maximum h11 dependency version to 0.10 (#772)</li> <li>Allow .json or .yaml --log-config files (#665)</li> <li>Add ASGI dict to the lifespan scope (#754)</li> <li>Upgrade wsproto to 0.15.0 (#750)</li> <li>Use optional package installs (#666)</li> </ul>"},{"location":"release-notes/#changed_10","title":"Changed","text":"<ul> <li>Don't set log level for root logger (#767) 8/28/20 df81b168</li> <li>Uvicorn no longer ships extra dependencies <code>uvloop</code>, <code>websockets</code> and <code>httptools</code> as default.   To install these dependencies use <code>uvicorn[standard]</code>.</li> </ul>"},{"location":"release-notes/#fixed_44","title":"Fixed","text":"<ul> <li>Revert \"Improve shutdown robustness when using <code>--reload</code> or multiprocessing (#620)\" (#756)</li> <li>Fix terminate error in windows (#744)</li> <li>Fix bug where --log-config disables uvicorn loggers (#512)</li> </ul>"},{"location":"release-notes/#0118-july-30-2020","title":"0.11.8 (July 30, 2020)","text":"<ul> <li>Fix a regression that caused Uvicorn to crash when using <code>--interface=wsgi</code>. (#730)</li> <li>Fix a regression that caused Uvicorn to crash when using unix domain sockets. (#729)</li> </ul>"},{"location":"release-notes/#0117-july-28-2020","title":"0.11.7 (July 28, 2020)","text":"<ul> <li>SECURITY FIX: Prevent sending invalid HTTP header names and values. (#725)</li> <li>SECURITY FIX: Ensure path value is escaped before logging to the console. (#724)</li> <li>Fix <code>--proxy-headers</code> client IP and host when using a Unix socket. (#636)</li> </ul>"},{"location":"release-notes/#0116-july-17-2020","title":"0.11.6 (July 17, 2020)","text":"<ul> <li>Fix overriding the root logger.</li> </ul>"},{"location":"release-notes/#0115-april-29-2020","title":"0.11.5 (April 29, 2020)","text":"<ul> <li>Revert \"Watch all files, not just .py\" due to unexpected side effects.</li> <li>Revert \"Pass through gunicorn timeout config.\" due to unexpected side effects.</li> </ul>"},{"location":"release-notes/#0114-april-28-2020","title":"0.11.4 (April 28, 2020)","text":"<ul> <li>Use <code>watchgod</code>, if installed, for watching code changes.</li> <li>Watch all files, not just .py.</li> <li>Pass through gunicorn timeout config.</li> </ul>"},{"location":"release-notes/#0113-february-17-2020","title":"0.11.3 (February 17, 2020)","text":"<ul> <li>Update dependencies.</li> </ul>"},{"location":"release-notes/#0112-january-20-2020","title":"0.11.2 (January 20, 2020)","text":"<ul> <li>Don't open socket until after application startup.</li> <li>Support <code>--backlog</code>.</li> </ul>"},{"location":"release-notes/#0111-december-20-2019","title":"0.11.1 (December 20, 2019)","text":"<ul> <li>Use a more liberal <code>h11</code> dependency. Either <code>0.8.*</code> or `0.9.*``.</li> </ul>"},{"location":"release-notes/#0110-december-20-2019","title":"0.11.0 (December 20, 2019)","text":"<ul> <li>Fix reload/multiprocessing on Windows with Python 3.8.</li> <li>Drop IOCP support. (Required for fix above.)</li> <li>Add <code>uvicorn --version</code> flag.</li> <li>Add <code>--use-colors</code> and <code>--no-use-colors</code> flags.</li> <li>Display port correctly, when auto port selection isused with <code>--port=0</code>.</li> </ul>"},{"location":"release-notes/#0108-november-12-2019","title":"0.10.8 (November 12, 2019)","text":"<ul> <li>Fix reload/multiprocessing error.</li> </ul>"},{"location":"release-notes/#0107-november-12-2019","title":"0.10.7 (November 12, 2019)","text":"<ul> <li>Use resource_sharer.DupSocket to resolve socket sharing on Windows.</li> </ul>"},{"location":"release-notes/#0106-november-12-2019","title":"0.10.6 (November 12, 2019)","text":"<ul> <li>Exit if <code>workers</code> or <code>reload</code> are use without an app import string style.</li> <li>Reorganise supervisor processes to properly hand over sockets on windows.</li> </ul>"},{"location":"release-notes/#0105-november-12-2019","title":"0.10.5 (November 12, 2019)","text":"<ul> <li>Update uvloop dependency to 0.14+</li> </ul>"},{"location":"release-notes/#0104-november-9-2019","title":"0.10.4 (November 9, 2019)","text":"<ul> <li>Error clearly when <code>workers=&lt;NUM&gt;</code> is used with app instance, instead of an app import string.</li> <li>Switch <code>--reload-dir</code> to current working directory by default.</li> </ul>"},{"location":"release-notes/#0103-november-1-2019","title":"0.10.3 (November 1, 2019)","text":"<ul> <li>Add <code>`--log-level trace</code></li> </ul>"},{"location":"release-notes/#0102-october-31-2019","title":"0.10.2 (October 31, 2019)","text":"<ul> <li>Enable --proxy-headers by default.</li> </ul>"},{"location":"release-notes/#0101-october-31-2019","title":"0.10.1 (October 31, 2019)","text":"<ul> <li>Resolve issues with logging when using <code>--reload</code> or <code>--workers</code>.</li> <li>Setup up root logger to capture output for all logger instances, not just <code>uvicorn.error</code> and <code>uvicorn.access</code>.</li> </ul>"},{"location":"release-notes/#0100-october-29-2019","title":"0.10.0 (October 29, 2019)","text":"<ul> <li>Support for Python 3.8</li> <li>Separated out <code>uvicorn.error</code> and <code>uvicorn.access</code> logs.</li> <li>Coloured log output when connected to a terminal.</li> <li>Dropped <code>logger=</code> config setting.</li> <li>Added <code>--log-config [FILE]</code> and <code>log_config=[str|dict]</code>. May either be a Python logging config dictionary or the file name of a logging configuration.</li> <li>Added <code>--forwarded_allow_ips</code> and <code>forwarded_allow_ips</code>. Defaults to the value of the <code>$FORWARDED_ALLOW_IPS</code> environment variable or \"127.0.0.1\". The <code>--proxy-headers</code> flag now defaults to <code>True</code>, but only trusted IPs are used to populate forwarding info.</li> <li>The <code>--workers</code> setting now defaults to the value of the <code>$WEB_CONCURRENCY</code> environment variable.</li> <li>Added support for <code>--env-file</code>. Requires <code>python-dotenv</code>.</li> </ul>"},{"location":"server-behavior/","title":"Server Behavior","text":"<p>Uvicorn is designed with particular attention to connection and resource management, in order to provide a robust server implementation. It aims to ensure graceful behavior to either server or client errors, and resilience to poor client behavior or denial of service attacks.</p>"},{"location":"server-behavior/#http-headers","title":"HTTP Headers","text":"<p>The <code>Server</code> and <code>Date</code> headers are added to all outgoing requests.</p> <p>If a <code>Connection: Close</code> header is included then Uvicorn will close the connection after the response. Otherwise connections will stay open, pending the keep-alive timeout.</p> <p>If a <code>Content-Length</code> header is included then Uvicorn will ensure that the content length of the response body matches the value in the header, and raise an error otherwise.</p> <p>If no <code>Content-Length</code> header is included then Uvicorn will use chunked encoding for the response body, and will set a <code>Transfer-Encoding</code> header if required.</p> <p>If a <code>Transfer-Encoding</code> header is included then any <code>Content-Length</code> header will be ignored.</p> <p>HTTP headers are mandated to be case-insensitive. Uvicorn will always send response headers strictly in lowercase.</p>"},{"location":"server-behavior/#flow-control","title":"Flow Control","text":"<p>Proper flow control ensures that large amounts of data do not become buffered on the transport when either side of a connection is sending data faster than its counterpart is able to handle.</p>"},{"location":"server-behavior/#write-flow-control","title":"Write flow control","text":"<p>If the write buffer passes a high water mark, then Uvicorn ensures the ASGI <code>send</code> messages will only return once the write buffer has been drained below the low water mark.</p>"},{"location":"server-behavior/#read-flow-control","title":"Read flow control","text":"<p>Uvicorn will pause reading from a transport once the buffered request body hits a high water mark, and will only resume once <code>receive</code> has been called, or once the response has been sent.</p>"},{"location":"server-behavior/#request-and-response-bodies","title":"Request and Response bodies","text":""},{"location":"server-behavior/#response-completion","title":"Response completion","text":"<p>Once a response has been sent, Uvicorn will no longer buffer any remaining request body. Any later calls to <code>receive</code> will return an <code>http.disconnect</code> message.</p> <p>Together with the read flow control, this behavior ensures that responses that return without reading the request body will not stream any substantial amounts of data into memory.</p>"},{"location":"server-behavior/#expect-100-continue","title":"Expect: 100-Continue","text":"<p>The <code>Expect: 100-Continue</code> header may be sent by clients to require a confirmation from the server before uploading the request body. This can be used to ensure that large request bodies are only sent once the client has confirmation that the server is willing to accept the request.</p> <p>Uvicorn ensures that any required <code>100 Continue</code> confirmations are only sent if the ASGI application calls <code>receive</code> to read the request body.</p> <p>Note that proxy configurations may not necessarily forward on <code>Expect: 100-Continue</code> headers. In particular, Nginx defaults to buffering request bodies, and automatically sends <code>100 Continues</code> rather than passing the header on to the upstream server.</p>"},{"location":"server-behavior/#head-requests","title":"HEAD requests","text":"<p>Uvicorn will strip any response body from HTTP requests with the <code>HEAD</code> method.</p> <p>Applications should generally treat <code>HEAD</code> requests in the same manner as <code>GET</code> requests, in order to ensure that identical headers are sent in both cases, and that any ASGI middleware that modifies the headers will operate identically in either case.</p> <p>One exception to this might be if your application serves large file downloads, in which case you might wish to only generate the response headers.</p>"},{"location":"server-behavior/#timeouts","title":"Timeouts","text":"<p>Uvicorn provides the following timeouts:</p> <ul> <li>Keep-Alive. Defaults to 5 seconds. Between requests, connections must receive new data within this period or be disconnected.</li> </ul>"},{"location":"server-behavior/#resource-limits","title":"Resource Limits","text":"<p>Uvicorn provides the following resource limiting:</p> <ul> <li>Concurrency. Defaults to <code>None</code>. If set, this provides a maximum number of concurrent tasks or open connections that should be allowed. Any new requests or connections that occur once this limit has been reached will result in a \"503 Service Unavailable\" response. Setting this value to a limit that you know your servers are able to support will help ensure reliable resource usage, even against significantly over-resourced servers.</li> <li>Max requests. Defaults to <code>None</code>. If set, this provides a maximum number of HTTP requests that will be serviced before terminating a process. Together with a process manager this can be used to prevent memory leaks from impacting long running processes.</li> </ul>"},{"location":"server-behavior/#server-errors","title":"Server Errors","text":"<p>Server errors will be logged at the <code>error</code> log level. All logging defaults to being written to <code>stdout</code>.</p>"},{"location":"server-behavior/#exceptions","title":"Exceptions","text":"<p>If an exception is raised by an ASGI application, and a response has not yet been sent on the connection, then a <code>500 Server Error</code> HTTP response will be sent.</p> <p>Uvicorn sends the headers and the status code as soon as it receives from the ASGI application. This means that if the application sends a Response Start message with a status code of <code>200 OK</code>, and then an exception is raised, the response will still be sent with a status code of <code>200 OK</code>.</p>"},{"location":"server-behavior/#invalid-responses","title":"Invalid responses","text":"<p>Uvicorn will ensure that ASGI applications send the correct sequence of messages, and will raise errors otherwise. This includes checking for no response sent, partial response sent, or invalid message sequences being sent.</p>"},{"location":"server-behavior/#graceful-process-shutdown","title":"Graceful Process Shutdown","text":"<p>Graceful process shutdowns are particularly important during a restart period. During this period you want to:</p> <ul> <li>Start a number of new server processes to handle incoming requests, listening on the existing socket.</li> <li>Stop the previous server processes from listening on the existing socket.</li> <li>Close any connections that are not currently waiting on an HTTP response, and wait for any other connections to finalize their HTTP responses.</li> <li>Wait for any background tasks to run to completion, such as occurs when the ASGI application has sent the HTTP response, but the asyncio task has not yet run to completion.</li> </ul> <p>Uvicorn handles process shutdown gracefully, ensuring that connections are properly finalized, and all tasks have run to completion. During a shutdown period Uvicorn will ensure that responses and tasks must still complete within the configured timeout periods.</p>"},{"location":"server-behavior/#http-pipelining","title":"HTTP Pipelining","text":"<p>HTTP/1.1 provides support for sending multiple requests on a single connection, before having received each corresponding response. Servers are required to support HTTP pipelining, but it is now generally accepted to lead to implementation issues. It is not enabled on browsers, and may not necessarily be enabled on any proxies that the HTTP request passes through.</p> <p>Uvicorn supports pipelining pragmatically. It will queue up any pipelined HTTP requests, and pause reading from the underlying transport. It will not start processing pipelined requests until each response has been dealt with in turn.</p>"},{"location":"settings/","title":"Settings","text":"<p>Use the following options to configure Uvicorn, when running from the command line.</p>"},{"location":"settings/#configuration-methods","title":"Configuration Methods","text":"<p>There are three ways to configure Uvicorn:</p> <ol> <li> <p>Command Line: Use command line options when running Uvicorn directly.    <pre><code>uvicorn main:app --host 0.0.0.0 --port 8000\n</code></pre></p> </li> <li> <p>Programmatic: Use keyword arguments when running programmatically with <code>uvicorn.run()</code>.    <pre><code>uvicorn.run(\"main:app\", host=\"0.0.0.0\", port=8000)\n</code></pre></p> <p>Note</p> <p>When using <code>reload=True</code> or <code>workers=NUM</code>, you should put <code>uvicorn.run</code> into an <code>if __name__ == '__main__'</code> clause in the main module.</p> </li> <li> <p>Environment Variables: Use environment variables with the prefix <code>UVICORN_</code>.    <pre><code>export UVICORN_HOST=\"0.0.0.0\"\nexport UVICORN_PORT=\"8000\"\nuvicorn main:app\n</code></pre></p> </li> </ol> <p>CLI options and the arguments for <code>uvicorn.run()</code> take precedence over environment variables.</p> <p>Also note that <code>UVICORN_*</code> prefixed settings cannot be used from within an environment configuration file. Using an environment configuration file with the <code>--env-file</code> flag is intended for configuring the ASGI application that uvicorn runs, rather than configuring uvicorn itself.</p>"},{"location":"settings/#application","title":"Application","text":"<ul> <li><code>APP</code> - The ASGI application to run, in the format <code>\"&lt;module&gt;:&lt;attribute&gt;\"</code>.</li> <li><code>--factory</code> - Treat <code>APP</code> as an application factory, i.e. a <code>() -&gt; &lt;ASGI app&gt;</code> callable.</li> <li><code>--app-dir &lt;path&gt;</code> - Look for APP in the specified directory by adding it to the PYTHONPATH. Default: Current working directory.</li> </ul>"},{"location":"settings/#socket-binding","title":"Socket Binding","text":"<ul> <li><code>--host &lt;str&gt;</code> - Bind socket to this host. Use <code>--host 0.0.0.0</code> to make the application available on your local network. IPv6 addresses are supported, for example: <code>--host '::'</code>. Default: '127.0.0.1'.</li> <li><code>--port &lt;int&gt;</code> - Bind to a socket with this port. If set to 0, an available port will be picked. Default: 8000.</li> <li><code>--uds &lt;path&gt;</code> - Bind to a UNIX domain socket, for example <code>--uds /tmp/uvicorn.sock</code>. Useful if you want to run Uvicorn behind a reverse proxy.</li> <li><code>--fd &lt;int&gt;</code> - Bind to socket from this file descriptor. Useful if you want to run Uvicorn within a process manager.</li> </ul>"},{"location":"settings/#development","title":"Development","text":"<ul> <li><code>--reload</code> - Enable auto-reload. Uvicorn supports two versions of auto-reloading behavior enabled by this option. Default: False.</li> <li><code>--reload-dir &lt;path&gt;</code> - Specify which directories to watch for python file changes. May be used multiple times. If unused, then by default the whole current directory will be watched. If you are running programmatically use <code>reload_dirs=[]</code> and pass a list of strings.</li> <li><code>--reload-delay &lt;float&gt;</code> - Delay between previous and next check if application needs to be reloaded. Default: 0.25.</li> </ul>"},{"location":"settings/#reloading-without-watchfiles","title":"Reloading without watchfiles","text":"<p>If Uvicorn cannot load watchfiles at runtime, it will periodically look for changes in modification times to all <code>*.py</code> files (and only <code>*.py</code> files) inside of its monitored directories. See the <code>--reload-dir</code> option. Specifying other file extensions is not supported unless watchfiles is installed. See the <code>--reload-include</code> and <code>--reload-exclude</code> options for details.</p>"},{"location":"settings/#reloading-with-watchfiles","title":"Reloading with watchfiles","text":"<p>For more nuanced control over which file modifications trigger reloads, install <code>uvicorn[standard]</code>, which includes watchfiles as a dependency. Alternatively, install watchfiles where Uvicorn can see it.</p> <p>Using Uvicorn with watchfiles will enable the following options (which are otherwise ignored):</p> <ul> <li><code>--reload-include &lt;glob-pattern&gt;</code> - Specify a glob pattern to match files or directories which will be watched. May be used multiple times. By default the following patterns are included: <code>*.py</code>. These defaults can be overwritten by including them in <code>--reload-exclude</code>.</li> <li><code>--reload-exclude &lt;glob-pattern&gt;</code> - Specify a glob pattern to match files or directories which will excluded from watching. May be used multiple times. By default the following patterns are excluded: <code>.*, .py[cod], .sw.*, ~*</code>. These defaults can be overwritten by including them in <code>--reload-include</code>.</li> </ul> <p>Tip</p> <p>When using Uvicorn through WSL, you might have to set the <code>WATCHFILES_FORCE_POLLING</code> environment variable, for file changes to trigger a reload. See watchfiles documentation for further details.</p>"},{"location":"settings/#production","title":"Production","text":"<ul> <li><code>--workers &lt;int&gt;</code> - Number of worker processes. Defaults to the <code>$WEB_CONCURRENCY</code> environment variable if available, or 1. Not valid with <code>--reload</code>.</li> <li><code>--env-file &lt;path&gt;</code> - Environment configuration file for the ASGI application. Default: None.</li> </ul> <p>Note</p> <p>The <code>--reload</code> and <code>--workers</code> arguments are mutually exclusive. You cannot use both at the same time.</p>"},{"location":"settings/#logging","title":"Logging","text":"<ul> <li><code>--log-config &lt;path&gt;</code> - Logging configuration file. Options: <code>dictConfig()</code> formats: .json, .yaml. Any other format will be processed with <code>fileConfig()</code>. Set the <code>formatters.default.use_colors</code> and <code>formatters.access.use_colors</code> values to override the auto-detected behavior.<ul> <li>If you wish to use a YAML file for your logging config, you will need to include PyYAML as a dependency for your project or install uvicorn with the <code>[standard]</code> optional extras.</li> </ul> </li> <li><code>--log-level &lt;str&gt;</code> - Set the log level. Options: 'critical', 'error', 'warning', 'info', 'debug', 'trace'. Default: 'info'.</li> <li><code>--no-access-log</code> - Disable access log only, without changing log level.</li> <li><code>--use-colors / --no-use-colors</code> - Enable / disable colorized formatting of the log records. If not set, colors will be auto-detected. This option is ignored if the <code>--log-config</code> CLI option is used.</li> </ul>"},{"location":"settings/#implementation","title":"Implementation","text":"<ul> <li><code>--loop &lt;str&gt;</code> - Set the event loop implementation. The uvloop implementation provides greater performance, but is not compatible with Windows or PyPy. Options: 'auto', 'asyncio', 'uvloop'. Default: 'auto'.</li> <li><code>--http &lt;str&gt;</code> - Set the HTTP protocol implementation. The httptools implementation provides greater performance, but it not compatible with PyPy. Options: 'auto', 'h11', 'httptools'. Default: 'auto'.</li> <li><code>--ws &lt;str&gt;</code> - Set the WebSockets protocol implementation. Either of the <code>websockets</code> and <code>wsproto</code> packages are supported. There are two versions of <code>websockets</code> supported: <code>websockets</code> and <code>websockets-sansio</code>. Use <code>'none'</code> to ignore all websocket requests. Options: 'auto', 'none', 'websockets', 'websockets-sansio', 'wsproto'. Default: 'auto'.</li> <li><code>--ws-max-size &lt;int&gt;</code> - Set the WebSockets max message size, in bytes. Only available with the <code>websockets</code> protocol. Default: 16777216 (16 MB).</li> <li><code>--ws-max-queue &lt;int&gt;</code> - Set the maximum length of the WebSocket incoming message queue. Only available with the <code>websockets</code> protocol. Default: 32.</li> <li><code>--ws-ping-interval &lt;float&gt;</code> - Set the WebSockets ping interval, in seconds. Only available with the <code>websockets</code> protocol. Default: 20.0.</li> <li><code>--ws-ping-timeout &lt;float&gt;</code> - Set the WebSockets ping timeout, in seconds. Only available with the <code>websockets</code> protocol. Default: 20.0.</li> <li><code>--ws-per-message-deflate &lt;bool&gt;</code> - Enable/disable WebSocket per-message-deflate compression. Only available with the <code>websockets</code> protocol. Default: True.</li> <li><code>--lifespan &lt;str&gt;</code> - Set the Lifespan protocol implementation. Options: 'auto', 'on', 'off'. Default: 'auto'.</li> <li><code>--h11-max-incomplete-event-size &lt;int&gt;</code> - Set the maximum number of bytes to buffer of an incomplete event. Only available for <code>h11</code> HTTP protocol implementation. Default: 16384 (16 KB).</li> </ul>"},{"location":"settings/#application-interface","title":"Application Interface","text":"<ul> <li><code>--interface &lt;str&gt;</code> - Select ASGI3, ASGI2, or WSGI as the application interface. Note that WSGI mode always disables WebSocket support, as it is not supported by the WSGI interface. Options: 'auto', 'asgi3', 'asgi2', 'wsgi'. Default: 'auto'.</li> </ul> <p>Warning</p> <p>Uvicorn's native WSGI implementation is deprecated, you should switch to a2wsgi (<code>pip install a2wsgi</code>).</p>"},{"location":"settings/#http","title":"HTTP","text":"<ul> <li><code>--root-path &lt;str&gt;</code> - Set the ASGI <code>root_path</code> for applications submounted below a given URL path. Default: \"\".</li> <li><code>--proxy-headers / --no-proxy-headers</code> - Enable/Disable X-Forwarded-Proto, X-Forwarded-For to populate remote address info. Defaults to enabled, but is restricted to only trusting connecting IPs in the <code>forwarded-allow-ips</code> configuration.</li> <li><code>--forwarded-allow-ips &lt;comma-separated-list&gt;</code> - Comma separated list of IP Addresses, IP Networks, or literals (e.g. UNIX Socket path) to trust with proxy headers. Defaults to the <code>$FORWARDED_ALLOW_IPS</code> environment variable if available, or '127.0.0.1'. The literal <code>'*'</code> means trust everything.</li> <li><code>--server-header / --no-server-header</code> - Enable/Disable default <code>Server</code> header. Default: True.</li> <li><code>--date-header / --no-date-header</code> - Enable/Disable default <code>Date</code> header. Default: True.</li> <li><code>--header &lt;name:value&gt;</code> - Specify custom default HTTP response headers as a Name:Value pair. May be used multiple times.</li> </ul> <p>Note</p> <p>The <code>--no-date-header</code> flag doesn't have effect on the <code>websockets</code> implementation.</p>"},{"location":"settings/#https","title":"HTTPS","text":"<p>The SSL context can be configured with the following options:</p> <ul> <li><code>--ssl-keyfile &lt;path&gt;</code> - The SSL key file.</li> <li><code>--ssl-keyfile-password &lt;str&gt;</code> - The password to decrypt the ssl key.</li> <li><code>--ssl-certfile &lt;path&gt;</code> - The SSL certificate file.</li> <li><code>--ssl-version &lt;int&gt;</code> - The SSL version to use. Default: ssl.PROTOCOL_TLS_SERVER.</li> <li><code>--ssl-cert-reqs &lt;int&gt;</code> - Whether client certificate is required. Default: ssl.CERT_NONE.</li> <li><code>--ssl-ca-certs &lt;str&gt;</code> - The CA certificates file.</li> <li><code>--ssl-ciphers &lt;str&gt;</code> - The ciphers to use. Default: \"TLSv1\".</li> </ul> <p>To understand more about the SSL context options, please refer to the Python documentation.</p>"},{"location":"settings/#resource-limits","title":"Resource Limits","text":"<ul> <li><code>--limit-concurrency &lt;int&gt;</code> - Maximum number of concurrent connections or tasks to allow, before issuing HTTP 503 responses. Useful for ensuring known memory usage patterns even under over-resourced loads.</li> <li><code>--limit-max-requests &lt;int&gt;</code> - Maximum number of requests to service before terminating the process. Useful when running together with a process manager, for preventing memory leaks from impacting long-running processes.</li> <li><code>--backlog &lt;int&gt;</code> - Maximum number of connections to hold in backlog. Relevant for heavy incoming traffic. Default: 2048.</li> </ul>"},{"location":"settings/#timeouts","title":"Timeouts","text":"<ul> <li><code>--timeout-keep-alive &lt;int&gt;</code> - Close Keep-Alive connections if no new data is received within this timeout. Default: 5.</li> <li><code>--timeout-graceful-shutdown &lt;int&gt;</code> - Maximum number of seconds to wait for graceful shutdown. After this timeout, the server will start terminating requests.</li> </ul>"},{"location":"sponsorship/","title":"\u2728 Sponsor Starlette &amp; Uvicorn \u2728","text":"<p>Thank you for your interest in sponsoring Starlette and Uvicorn! \u2764\ufe0f</p> <p>Your support directly contributes to the ongoing development, maintenance, and long-term sustainability of both projects.</p> 67M+ <p>Starlette Downloads/Month</p> 57M+ <p>Uvicorn Downloads/Month</p> 19K+ <p>Combined GitHub Stars</p>"},{"location":"sponsorship/#why-sponsor","title":"Why Sponsor?","text":"<p>While Starlette and Uvicorn are part of the Encode organization, they have been primarily maintained by Marcelo Trylesinski (Kludex) for the past several years. His dedication and consistent work have been instrumental in keeping these projects robust, secure, and up-to-date.</p> <p>This sponsorship page was created to give the community an opportunity to support Marcelo's continued efforts in maintaining and improving both projects. Your sponsorship directly enables him to dedicate more time and resources to maintaining and improving these essential tools:</p> <ul> <li> Active Development: Developing new features, enhancing existing ones, and   keeping both projects aligned with the latest developments in the Python and ASGI ecosystems. \ud83d\udcbb</li> <li> Community Support: Providing better support, addressing user issues,   and cultivating a welcoming environment for contributors. \ud83e\udd1d</li> <li> Long-Term Stability: Ensuring the long-term viability of both projects through strategic   planning and addressing technical debt. \ud83c\udf33</li> <li> Bug Fixes &amp; Maintenance: Providing prompt attention to bug reports and   general maintenance to keep the projects reliable. \ud83d\udd28</li> <li> Security: Ensuring robust security practices, conducting regular security audits, and   promptly addressing vulnerabilities to protect millions of production deployments. \ud83d\udd12</li> <li> Documentation: Creating comprehensive guides, tutorials, and examples to help users of all skill levels. \ud83d\udcd6</li> </ul>"},{"location":"sponsorship/#how-sponsorship-works","title":"How Sponsorship Works\ud83c\udf1f Become a Sponsor Today! \ud83c\udf1f","text":"<p>We currently manage sponsorships exclusively through GitHub Sponsors. This platform integrates seamlessly with the GitHub ecosystem, making it easy for organizations to contribute.</p> <p>Your support helps keep Starlette and Uvicorn growing stronger!</p>          \u2764\ufe0f Sponsor on GitHub"},{"location":"sponsorship/#sponsorship-tiers","title":"Sponsorship Tiers \ud83c\udf81","text":"\ud83e\udd49 Bronze Sponsor $100/month <ul> <li>\u2713 Company name on Sponsors page</li> <li>\u2713 Small logo with link</li> <li>\u2713 Our eternal gratitude</li> </ul>                  Become a Bronze Sponsor              \ud83e\udd48 Silver Sponsor $250/month <ul> <li>\u2713 All Bronze benefits</li> <li>\u2713 Medium-sized logo</li> <li>\u2713 Release notes mention</li> </ul>                  Become a Silver Sponsor                           Popular          \ud83e\udd47 Gold Sponsor $500/month <ul> <li>\u2713 All Silver benefits</li> <li>\u2713 Large logo on main pages</li> <li>\u2713 Priority support</li> </ul>                  Become a Gold Sponsor              \ud83e\udd1d Custom Sponsor <p>Looking for something different? Contact us to discuss custom sponsorship options!</p>"},{"location":"sponsorship/#current-sponsors","title":"Current Sponsors","text":"<p>Thank you to our generous sponsors! \ud83d\ude4f</p> \ud83c\udfc6 Gold Sponsors <p>Modern, fast web framework for building APIs with Python 3.8+</p> \ud83e\udd48 Silver Sponsors \ud83e\udd49 Bronze Sponsors"},{"location":"sponsorship/#alternative-sponsorship-platforms","title":"Alternative Sponsorship Platforms","text":"\ud83d\udce2 We Want Your Input! <p>We are currently evaluating whether to expand our sponsorship options beyond GitHub Sponsors. If your company would be interested in sponsoring Starlette and Uvicorn but prefers to use a different platform (e.g., Open Collective, direct invoicing), please let us know!</p> <p>Your feedback is invaluable in helping us make sponsorship as accessible as possible. Share your thoughts by:</p> <ul> <li>Opening a discussion on our GitHub repository</li> <li>Contacting us directly at marcelotryle@gmail.com</li> </ul> <p></p>"},{"location":"sponsorship/#community-future-plans","title":"Community &amp; Future Plans \ud83c\udf1f","text":"<p>We want to express our deepest gratitude to all the contributors who have helped shape Starlette and Uvicorn over the years. These projects wouldn't be what they are today without the incredible work of every single contributor.</p> <p>Special thanks to some of our most impactful contributors:</p> <ul> <li>Tom Christie (@tomchristie) - The original creator of Starlette and Uvicorn.</li> <li>Adrian Garcia Badaracco (@adriangb) - Major contributor to Starlette.</li> <li>Thomas Grainger (@graingert) - Major contributor to AnyIO, and significant contributions to Starlette and Uvicorn.</li> <li>Alex Gr\u00f6nholm (@agronholm) - Creator of AnyIO.</li> <li>Florimond Manca (@florimondmanca) - Important contributions to Starlette and Uvicorn.</li> </ul> <p>If you want your name removed from the list above, or if I forgot a significant contributor, please let me know. You can view all contributors on GitHub: Starlette Contributors / Uvicorn Contributors.</p> <p>While the current sponsorship program directly supports Marcelo's maintenance work, we are exploring ways to distribute funding to other key contributors in the future. This initiative is still in early planning stages, as we want to ensure a fair and sustainable model that recognizes the valuable contributions of our community members.</p>"},{"location":"deployment/","title":"Deployment","text":"<p>Server deployment is a complex area, that will depend on what kind of service you're deploying Uvicorn onto.</p> <p>As a general rule, you probably want to:</p> <ul> <li>Run <code>uvicorn --reload</code> from the command line for local development.</li> <li>Run <code>gunicorn -k uvicorn.workers.UvicornWorker</code> for production.</li> <li>Additionally run behind Nginx for self-hosted deployments.</li> <li>Finally, run everything behind a CDN for caching support, and serious DDOS protection.</li> </ul>"},{"location":"deployment/#running-from-the-command-line","title":"Running from the command line","text":"<p>Typically you'll run <code>uvicorn</code> from the command line.</p> <pre><code>$ uvicorn main:app --reload --port 5000\n</code></pre> <p>The ASGI application should be specified in the form <code>path.to.module:instance.path</code>.</p> <p>When running locally, use <code>--reload</code> to turn on auto-reloading.</p> <p>The <code>--reload</code> and <code>--workers</code> arguments are mutually exclusive.</p> <p>To see the complete set of available options, use <code>uvicorn --help</code>:</p> <pre><code>Usage: uvicorn [OPTIONS] APP\n\nOptions:\n  --host TEXT                     Bind socket to this host.  [default:\n                                  127.0.0.1]\n  --port INTEGER                  Bind socket to this port. If 0, an available\n                                  port will be picked.  [default: 8000]\n  --uds TEXT                      Bind to a UNIX domain socket.\n  --fd INTEGER                    Bind to socket from this file descriptor.\n  --reload                        Enable auto-reload.\n  --reload-dir PATH               Set reload directories explicitly, instead\n                                  of using the current working directory.\n  --reload-include TEXT           Set glob patterns to include while watching\n                                  for files. Includes '*.py' by default; these\n                                  defaults can be overridden with `--reload-\n                                  exclude`. This option has no effect unless\n                                  watchfiles is installed.\n  --reload-exclude TEXT           Set glob patterns to exclude while watching\n                                  for files. Includes '.*, .py[cod], .sw.*,\n                                  ~*' by default; these defaults can be\n                                  overridden with `--reload-include`. This\n                                  option has no effect unless watchfiles is\n                                  installed.\n  --reload-delay FLOAT            Delay between previous and next check if\n                                  application needs to be. Defaults to 0.25s.\n                                  [default: 0.25]\n  --workers INTEGER               Number of worker processes. Defaults to the\n                                  $WEB_CONCURRENCY environment variable if\n                                  available, or 1. Not valid with --reload.\n  --loop [auto|asyncio|uvloop]    Event loop implementation.  [default: auto]\n  --http [auto|h11|httptools]     HTTP protocol implementation.  [default:\n                                  auto]\n  --ws [auto|none|websockets|websockets-sansio|wsproto]\n                                  WebSocket protocol implementation.\n                                  [default: auto]\n  --ws-max-size INTEGER           WebSocket max size message in bytes\n                                  [default: 16777216]\n  --ws-max-queue INTEGER          The maximum length of the WebSocket message\n                                  queue.  [default: 32]\n  --ws-ping-interval FLOAT        WebSocket ping interval in seconds.\n                                  [default: 20.0]\n  --ws-ping-timeout FLOAT         WebSocket ping timeout in seconds.\n                                  [default: 20.0]\n  --ws-per-message-deflate BOOLEAN\n                                  WebSocket per-message-deflate compression\n                                  [default: True]\n  --lifespan [auto|on|off]        Lifespan implementation.  [default: auto]\n  --interface [auto|asgi3|asgi2|wsgi]\n                                  Select ASGI3, ASGI2, or WSGI as the\n                                  application interface.  [default: auto]\n  --env-file PATH                 Environment configuration file.\n  --log-config PATH               Logging configuration file. Supported\n                                  formats: .ini, .json, .yaml.\n  --log-level [critical|error|warning|info|debug|trace]\n                                  Log level. [default: info]\n  --access-log / --no-access-log  Enable/Disable access log.\n  --use-colors / --no-use-colors  Enable/Disable colorized logging.\n  --proxy-headers / --no-proxy-headers\n                                  Enable/Disable X-Forwarded-Proto,\n                                  X-Forwarded-For to populate url scheme and\n                                  remote address info.\n  --server-header / --no-server-header\n                                  Enable/Disable default Server header.\n  --date-header / --no-date-header\n                                  Enable/Disable default Date header.\n  --forwarded-allow-ips TEXT      Comma separated list of IP Addresses, IP\n                                  Networks, or literals (e.g. UNIX Socket\n                                  path) to trust with proxy headers. Defaults\n                                  to the $FORWARDED_ALLOW_IPS environment\n                                  variable if available, or '127.0.0.1'. The\n                                  literal '*' means trust everything.\n  --root-path TEXT                Set the ASGI 'root_path' for applications\n                                  submounted below a given URL path.\n  --limit-concurrency INTEGER     Maximum number of concurrent connections or\n                                  tasks to allow, before issuing HTTP 503\n                                  responses.\n  --backlog INTEGER               Maximum number of connections to hold in\n                                  backlog\n  --limit-max-requests INTEGER    Maximum number of requests to service before\n                                  terminating the process.\n  --timeout-keep-alive INTEGER    Close Keep-Alive connections if no new data\n                                  is received within this timeout.  [default:\n                                  5]\n  --timeout-graceful-shutdown INTEGER\n                                  Maximum number of seconds to wait for\n                                  graceful shutdown.\n  --ssl-keyfile TEXT              SSL key file\n  --ssl-certfile TEXT             SSL certificate file\n  --ssl-keyfile-password TEXT     SSL keyfile password\n  --ssl-version INTEGER           SSL version to use (see stdlib ssl module's)\n                                  [default: 17]\n  --ssl-cert-reqs INTEGER         Whether client certificate is required (see\n                                  stdlib ssl module's)  [default: 0]\n  --ssl-ca-certs TEXT             CA certificates file\n  --ssl-ciphers TEXT              Ciphers to use (see stdlib ssl module's)\n                                  [default: TLSv1]\n  --header TEXT                   Specify custom default HTTP response headers\n                                  as a Name:Value pair\n  --version                       Display the uvicorn version and exit.\n  --app-dir TEXT                  Look for APP in the specified directory, by\n                                  adding this to the PYTHONPATH. Defaults to\n                                  the current working directory.  [default:\n                                  \"\"]\n  --h11-max-incomplete-event-size INTEGER\n                                  For h11, the maximum number of bytes to\n                                  buffer of an incomplete event.\n  --factory                       Treat APP as an application factory, i.e. a\n                                  () -&gt; &lt;ASGI app&gt; callable.\n  --help                          Show this message and exit.\n</code></pre> <p>See the settings documentation for more details on the supported options for running uvicorn.</p>"},{"location":"deployment/#running-programmatically","title":"Running programmatically","text":"<p>To run directly from within a Python program, you should use <code>uvicorn.run(app, **config)</code>. For example:</p> main.py<pre><code>import uvicorn\n\nclass App:\n    ...\n\napp = App()\n\nif __name__ == \"__main__\":\n    uvicorn.run(\"main:app\", host=\"127.0.0.1\", port=5000, log_level=\"info\")\n</code></pre> <p>The set of configuration options is the same as for the command line tool.</p> <p>Note that the application instance itself can be passed instead of the app import string.</p> <pre><code>uvicorn.run(app, host=\"127.0.0.1\", port=5000, log_level=\"info\")\n</code></pre> <p>However, this style only works if you are not using multiprocessing (<code>workers=NUM</code>) or reloading (<code>reload=True</code>), so we recommend using the import string style.</p> <p>Also note that in this case, you should put <code>uvicorn.run</code> into <code>if __name__ == '__main__'</code> clause in the main module.</p> <p>Note</p> <p>The <code>reload</code> and <code>workers</code> parameters are mutually exclusive.</p>"},{"location":"deployment/#using-a-process-manager","title":"Using a process manager","text":"<p>Running Uvicorn using a process manager ensures that you can run multiple processes in a resilient manner, and allows you to perform server upgrades without dropping requests.</p> <p>A process manager will handle the socket setup, start-up multiple server processes, monitor process aliveness, and listen for signals to provide for processes restarts, shutdowns, or dialing up and down the number of running processes.</p>"},{"location":"deployment/#built-in","title":"Built-in","text":"<p>Uvicorn includes a <code>--workers</code> option that allows you to run multiple worker processes.</p> <pre><code>$ uvicorn main:app --workers 4\n</code></pre> <p>Unlike gunicorn, uvicorn does not use pre-fork, but uses <code>spawn</code>, which allows uvicorn's multiprocess manager to still work well on Windows.</p> <p>The default process manager monitors the status of child processes and automatically restarts child processes that die unexpectedly. Not only that, it will also monitor the status of the child process through the pipeline. When the child process is accidentally stuck, the corresponding child process will be killed through an unstoppable system signal or interface.</p> <p>You can also manage child processes by sending specific signals to the main process. (Not supported on Windows.)</p> <ul> <li><code>SIGHUP</code>: Work processeses are graceful restarted one after another. If you update the code, the new worker process will use the new code.</li> <li><code>SIGTTIN</code>: Increase the number of worker processes by one.</li> <li><code>SIGTTOU</code>: Decrease the number of worker processes by one.</li> </ul>"},{"location":"deployment/#gunicorn","title":"Gunicorn","text":"<p>Warning</p> <p>The <code>uvicorn.workers</code> module is deprecated and will be removed in a future release.</p> <p>You should use the <code>uvicorn-worker</code> package instead.</p> <pre><code>python -m pip install uvicorn-worker\n</code></pre> <p>Gunicorn is probably the simplest way to run and manage Uvicorn in a production setting. Uvicorn includes a gunicorn worker class that means you can get set up with very little configuration.</p> <p>The following will start Gunicorn with four worker processes:</p> <p><code>gunicorn -w 4 -k uvicorn.workers.UvicornWorker</code></p> <p>The <code>UvicornWorker</code> implementation uses the <code>uvloop</code> and <code>httptools</code> implementations. To run under PyPy you'll want to use pure-python implementation instead. You can do this by using the <code>UvicornH11Worker</code> class.</p> <p><code>gunicorn -w 4 -k uvicorn.workers.UvicornH11Worker</code></p> <p>Gunicorn provides a different set of configuration options to Uvicorn, so  some options such as <code>--limit-concurrency</code> are not yet supported when running with Gunicorn.</p> <p>If you need to pass uvicorn's config arguments to gunicorn workers then you'll have to subclass <code>UvicornWorker</code>:</p> <pre><code>from uvicorn.workers import UvicornWorker\n\nclass MyUvicornWorker(UvicornWorker):\n    CONFIG_KWARGS = {\"loop\": \"asyncio\", \"http\": \"h11\", \"lifespan\": \"off\"}\n</code></pre>"},{"location":"deployment/#supervisor","title":"Supervisor","text":"<p>To use <code>supervisor</code> as a process manager you should either:</p> <ul> <li>Hand over the socket to uvicorn using its file descriptor, which supervisor always makes available as <code>0</code>, and which must be set in the <code>fcgi-program</code> section.</li> <li>Or use a UNIX domain socket for each <code>uvicorn</code> process.</li> </ul> <p>A simple supervisor configuration might look something like this:</p> supervisord.conf<pre><code>[supervisord]\n\n[fcgi-program:uvicorn]\nsocket=tcp://localhost:8000\ncommand=venv/bin/uvicorn --fd 0 main:App\nnumprocs=4\nprocess_name=uvicorn-%(process_num)d\nstdout_logfile=/dev/stdout\nstdout_logfile_maxbytes=0\n</code></pre> <p>Then run with <code>supervisord -n</code>.</p>"},{"location":"deployment/#running-behind-nginx","title":"Running behind Nginx","text":"<p>Using Nginx as a proxy in front of your Uvicorn processes may not be necessary, but is recommended for additional resilience. Nginx can deal with serving your static media and buffering slow requests, leaving your application servers free from load as much as possible.</p> <p>In managed environments such as <code>Heroku</code>, you won't typically need to configure Nginx, as your server processes will already be running behind load balancing proxies.</p> <p>The recommended configuration for proxying from Nginx is to use a UNIX domain socket between Nginx and whatever the process manager that is being used to run Uvicorn. If using Uvicorn directly you can bind it to a UNIX domain socket using <code>uvicorn --uds /path/to/socket.sock &lt;...&gt;</code>.</p> <p>When running your application behind one or more proxies you will want to make sure that each proxy sets appropriate headers to ensure that your application can properly determine the client address of the incoming connection, and if the connection was over <code>http</code> or <code>https</code>. For more information see Proxies and Forwarded Headers below.</p> <p>Here's how a simple Nginx configuration might look. This example includes setting proxy headers, and using a UNIX domain socket to communicate with the application server.</p> <p>It also includes some basic configuration to forward websocket connections. For more info on this, check Nginx recommendations.</p> <pre><code>http {\n  server {\n    listen 80;\n    client_max_body_size 4G;\n\n    server_name example.com;\n\n    location / {\n      proxy_set_header Host $http_host;\n      proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;\n      proxy_set_header X-Forwarded-Proto $scheme;\n      proxy_set_header Upgrade $http_upgrade;\n      proxy_set_header Connection $connection_upgrade;\n      proxy_redirect off;\n      proxy_buffering off;\n      proxy_pass http://uvicorn;\n    }\n\n    location /static {\n      # path for static files\n      root /path/to/app/static;\n    }\n  }\n\n  map $http_upgrade $connection_upgrade {\n    default upgrade;\n    '' close;\n  }\n\n  upstream uvicorn {\n    server unix:/tmp/uvicorn.sock;\n  }\n\n}\n</code></pre> <p>Uvicorn's <code>--proxy-headers</code> behavior may not be sufficient for more complex proxy configurations that use different combinations of headers, or where the application is running behind more than one intermediary proxying service.</p> <p>In those cases, you might want to use an ASGI middleware to set the <code>client</code> and <code>scheme</code> dependant on the request headers.</p>"},{"location":"deployment/#running-behind-a-cdn","title":"Running behind a CDN","text":"<p>Running behind a content delivery network, such as Cloudflare or Cloud Front, provides a serious layer of protection against DDoS attacks. Your service will be running behind huge clusters of proxies and load balancers that are designed for handling huge amounts of traffic, and have capabilities for detecting and closing off connections from DDoS attacks.</p> <p>Proper usage of cache control headers can mean that a CDN is able to serve large amounts of data without always having to forward the request on to your server.</p> <p>Content Delivery Networks can also be a low-effort way to provide HTTPS termination.</p>"},{"location":"deployment/#running-with-https","title":"Running with HTTPS","text":"<p>To run uvicorn with https, a certificate and a private key are required. The recommended way to get them is using Let's Encrypt.</p> <p>For local development with https, it's possible to use mkcert to generate a valid certificate and private key.</p> <pre><code>$ uvicorn main:app --port 5000 --ssl-keyfile=./key.pem --ssl-certfile=./cert.pem\n</code></pre>"},{"location":"deployment/#running-gunicorn-worker","title":"Running gunicorn worker","text":"<p>It's also possible to use certificates with uvicorn's worker for gunicorn.</p> <pre><code>$ gunicorn --keyfile=./key.pem --certfile=./cert.pem -k uvicorn.workers.UvicornWorker main:app\n</code></pre>"},{"location":"deployment/#proxies-and-forwarded-headers","title":"Proxies and Forwarded Headers","text":"<p>When running an application behind one or more proxies, certain information about the request is lost. To avoid this most proxies will add headers containing this information for downstream servers to read.</p> <p>Uvicorn currently supports the following headers:</p> <ul> <li><code>X-Forwarded-For</code> (MDN Reference)</li> <li><code>X-Forwarded-Proto</code>(MDN Reference)</li> </ul> <p>Uvicorn can use these headers to correctly set the client and protocol in the request. However as anyone can set these headers you must configure which \"clients\" you will trust to have set them correctly.</p> <p>Uvicorn can be configured to trust IP Addresses (e.g. <code>127.0.0.1</code>), IP Networks (e.g. <code>10.100.0.0/16</code>), or Literals (e.g. <code>/path/to/socket.sock</code>). When running from CLI these are configured using <code>--forwarded-allow-ips</code>.</p> <p>Only trust clients you can actually trust!</p> <p>Incorrectly trusting other clients can lead to malicious actors spoofing their apparent client address to your application.</p> <p>For more information, check <code>ProxyHeadersMiddleware</code>.</p>"},{"location":"deployment/#client-port","title":"Client Port","text":"<p>Currently if the <code>ProxyHeadersMiddleware</code> is able to retrieve a trusted client value then the client's port will be set to <code>0</code>. This is because port information is lost when using these headers.</p>"},{"location":"deployment/#unix-domain-sockets-uds","title":"UNIX Domain Sockets (UDS)","text":"<p>Although it is common for UNIX Domain Sockets to be used for communicating between various HTTP servers, they can mess with some of the expected received values as they will be various non-address strings or missing values.</p> <p>For example:</p> <ul> <li>when NGINX itself is running behind a UDS it will add the literal <code>unix:</code> as the client in the <code>X-Forwarded-For</code> header.</li> <li>When Uvicorn is running behind a UDS the initial client will be <code>None</code>.</li> </ul>"},{"location":"deployment/#trust-everything","title":"Trust Everything","text":"<p>Rather than specifying what to trust, you can instruct Uvicorn to trust all clients using the literal <code>\"*\"</code>. You should only set this when you know you can trust all values within the forwarded headers (e.g. because your proxies remove the existing headers before setting their own).</p>"},{"location":"deployment/docker/","title":"Dockerfile","text":"<p>Docker is a popular choice for modern application deployment. However, creating a good Dockerfile from scratch can be challenging. This guide provides a solid foundation that works well for most Python projects.</p> <p>While the example below won't fit every use case, it offers an excellent starting point that you can adapt to your specific needs.</p>"},{"location":"deployment/docker/#quickstart","title":"Quickstart","text":"<p>For this example, we'll need to install <code>docker</code>, docker-compose and <code>uv</code>.</p> <p>Then, let's create a new project with <code>uv</code>:</p> <pre><code>uv init app\n</code></pre> <p>This will create a new project with a basic structure:</p> <pre><code>app/\n\u251c\u2500\u2500 main.py\n\u251c\u2500\u2500 pyproject.toml\n\u2514\u2500\u2500 README.md\n</code></pre> <p>On <code>main.py</code>, let's create a simple ASGI application:</p> main.py<pre><code>async def app(scope, receive, send):\n    body = \"Hello, world!\"\n    await send(\n        {\n            \"type\": \"http.response.start\",\n            \"status\": 200,\n            \"headers\": [\n                [b\"content-type\", b\"text/plain\"],\n                [b\"content-length\", len(body)],\n            ],\n        }\n    )\n    await send(\n        {\n            \"type\": \"http.response.body\",\n            \"body\": body.encode(\"utf-8\"),\n        }\n    )\n</code></pre> <p>We need to include <code>uvicorn</code> in the dependencies:</p> <pre><code>uv add uvicorn\n</code></pre> <p>This will also create a <code>uv.lock</code> file. </p> What is <code>uv.lock</code>? <p><code>uv.lock</code> is a <code>uv</code> specific lockfile. A lockfile is a file that contains the exact versions of the dependencies that were installed when the <code>uv.lock</code> file was created.</p> <p>This allows for deterministic builds and consistent deployments.</p> <p>Just to make sure everything is working, let's run the application:</p> <pre><code>uv run uvicorn main:app\n</code></pre> <p>You should see the following output:</p> <pre><code>INFO:     Started server process [62727]\nINFO:     Waiting for application startup.\nINFO:     ASGI 'lifespan' protocol appears unsupported.\nINFO:     Application startup complete.\nINFO:     Uvicorn running on http://127.0.0.1:8000 (Press CTRL+C to quit)\n</code></pre>"},{"location":"deployment/docker/#dockerfile_1","title":"Dockerfile","text":"<p>We'll create a cache-aware Dockerfile that optimizes build times. The key strategy is to install dependencies first, then copy the project files. This approach leverages Docker's caching mechanism to significantly speed up rebuilds.</p> Dockerfile<pre><code>FROM python:3.12-slim\nCOPY --from=ghcr.io/astral-sh/uv:latest /uv /uvx /bin/\n\n# Change the working directory to the `app` directory\nWORKDIR /app\n\n# Install dependencies\nRUN --mount=type=cache,target=/root/.cache/uv \\\n    --mount=type=bind,source=uv.lock,target=uv.lock \\\n    --mount=type=bind,source=pyproject.toml,target=pyproject.toml \\\n    uv sync --frozen --no-install-project\n\n# Copy the project into the image\nADD . /app\n\n# Sync the project\nRUN --mount=type=cache,target=/root/.cache/uv \\\n    uv sync --frozen\n\n# Run with uvicorn\nCMD [\"uv\", \"run\", \"uvicorn\", \"main:app\", \"--host\", \"0.0.0.0\", \"--port\", \"8000\"]\n</code></pre> <p>A common question is \"how many workers should I run?\". The image above uses a single Uvicorn worker. The recommended approach is to let your orchestration system manage the number of deployed containers rather than relying on the process manager inside the container.</p> <p>You can read more about this in the Decouple applications section of the Docker documentation.</p> <p>For production, create a non-root user!</p> <p>When running in production, you should create a non-root user and run the container as that user.</p> <p>To make sure it works, let's build the image and run it:</p> <pre><code>docker build -t my-app .\ndocker run -p 8000:8000 my-app\n</code></pre> <p>For more information on using uv with Docker, refer to the official uv Docker integration guide.</p>"},{"location":"deployment/docker/#docker-compose","title":"Docker Compose","text":"<p>When running in development, it's often useful to have a way to hot-reload the application when code changes.</p> <p>Let's create a <code>docker-compose.yml</code> file to run the application:</p> docker-compose.yml<pre><code>services:\n  backend:\n    build: .\n    ports:\n      - \"8000:8000\"\n    environment:\n      - UVICORN_RELOAD=true\n    volumes:\n      - .:/app\n    tty: true\n</code></pre> <p>You can run the application with <code>docker compose up</code> and it will automatically rebuild the image when code changes.</p> <p>Now you have a fully working development environment! </p>"}]}